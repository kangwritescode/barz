{"ast":null,"code":"import _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/ViewedBar/PostLikes/PostLikes.js\";\nimport React, { Component, useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport firebase from 'firebase';\nimport 'firebase/firestore';\nimport './PostLikes.css';\n\nconst PostLikes = props => {\n  // data\n  const _useState = useState(0),\n        _useState2 = _slicedToArray(_useState, 2),\n        points = _useState2[0],\n        setPoints = _useState2[1];\n\n  const _useState3 = useState(0),\n        _useState4 = _slicedToArray(_useState3, 2),\n        likes = _useState4[0],\n        setLikes = _useState4[1];\n\n  const _useState5 = useState(0),\n        _useState6 = _slicedToArray(_useState5, 2),\n        dislikes = _useState6[0],\n        setDislikes = _useState6[1];\n\n  const _useState7 = useState({}),\n        _useState8 = _slicedToArray(_useState7, 2),\n        myVote = _useState8[0],\n        setMyVote = _useState8[1]; // show likes\n\n\n  const _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        showLiker = _useState10[0],\n        setShowLiker = _useState10[1]; // timeouts\n\n\n  const _useState11 = useState(null),\n        _useState12 = _slicedToArray(_useState11, 2),\n        showLikerTimeout = _useState12[0],\n        setShowLikerTimeout = _useState12[1];\n\n  const _useState13 = useState(null),\n        _useState14 = _slicedToArray(_useState13, 2),\n        hideLikerTimeout = _useState14[0],\n        setHideLikerTimeout = _useState14[1]; // mouse states\n\n\n  const _useState15 = useState(false),\n        _useState16 = _slicedToArray(_useState15, 2),\n        isInsideVoteButton = _useState16[0],\n        setIsInsideVoteButton = _useState16[1];\n\n  const _useState17 = useState(false),\n        _useState18 = _slicedToArray(_useState17, 2),\n        isInsideVoter = _useState18[0],\n        setIsInsideVoter = _useState18[1];\n\n  useEffect(() => {\n    const thing = () => console.log('entered!!!');\n\n    document.getElementById('vote-icon').addEventListener('mouseenter', thing);\n    return () => {\n      document.getElementById('vote-icon').removeEventListener('mouseenter', thing);\n    };\n  }, []);\n  useEffect(() => {\n    const db = firebase.firestore();\n    const votesListener = db.collection('postVotes').where('pid', '==', props.viewedPost.pid).onSnapshot(snapshot => {\n      var points = 0;\n      var likes = 0;\n      var dislikes = 0;\n      var myVote = null; // for every vote of this post\n\n      snapshot.docs.forEach(vote => {\n        vote = vote.data();\n\n        if (vote.value === 1) {\n          likes += 1;\n        }\n\n        if (vote.value === -1) {\n          dislikes += 1;\n        }\n\n        if (vote.voterID === props.myUID) {\n          myVote = vote;\n        }\n      });\n      points = likes - dislikes < 0 ? 0 : likes - dislikes;\n      setPoints(points);\n      setLikes(likes);\n      setDislikes(dislikes);\n      setMyVote(myVote);\n    });\n    return () => {\n      votesListener();\n    };\n  }, [props.myUID, props.postSelected, props.viewedPost]); // vote container\n\n  const voteContainerEntered = () => {\n    setIsInsideVoteButton(true);\n    var showLikerDelay = window.setTimeout(() => {\n      setShowLiker(true);\n    }, 1000);\n    setShowLikerTimeout(showLikerDelay);\n  };\n\n  const voteContainerLeft = () => {\n    setIsInsideVoteButton(false);\n  }; //pop-up voter\n\n\n  const voterEntered = () => {\n    setIsInsideVoter(true);\n  };\n\n  const voterLeft = () => {\n    setIsInsideVoter(false); // if (!isInsideVoter) {\n    //     window.clearTimeout(showLikerTimeout)\n    // }\n  }; // render ~~~~~~~~~~~~~\n\n\n  const pointsPercentage = likes > 0 ? Math.floor(likes * 1.0 / (likes + dislikes * 1.0) * 100) : null;\n  var iconStyle = 'fire';\n  var iconColor = myVote.value ? 'lit' : '';\n\n  if (myVote.value === -1) {\n    iconStyle = 'trash';\n  }\n\n  const liker = React.createElement(\"div\", {\n    className: \"likes__pop-up-voter-container\",\n    onMouseEnter: voterEntered,\n    onMouseLeave: voterLeft,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pop-up-voter-container__pop-up-voter\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }));\n  return React.createElement(\"div\", {\n    className: \"likes\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, showLiker ? liker : null, React.createElement(\"div\", {\n    className: \"vote-icon-container\",\n    id: \"vote-icon\",\n    onMouseEnter: voteContainerEntered,\n    onMouseLeave: voteContainerLeft,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fas fa-\".concat(iconStyle, \" vote-icon-container__\").concat(iconStyle, \" \").concat(iconColor),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"total-score\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, points, \" pt\", points === 1 ? null : 's', \". \", pointsPercentage ? '(' + pointsPercentage + '%)' : null), React.createElement(\"div\", {\n    className: \"fans\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, likes, \" \", likes === 1 ? 'like' : 'likes'));\n};\n\nconst mapStatetoProps = state => {\n  return {\n    myUID: state.uid\n  };\n};\n\nexport default connect(mapStatetoProps, null)(PostLikes);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/ViewedBar/PostLikes/PostLikes.js"],"names":["React","Component","useState","useEffect","connect","firebase","PostLikes","props","points","setPoints","likes","setLikes","dislikes","setDislikes","myVote","setMyVote","showLiker","setShowLiker","showLikerTimeout","setShowLikerTimeout","hideLikerTimeout","setHideLikerTimeout","isInsideVoteButton","setIsInsideVoteButton","isInsideVoter","setIsInsideVoter","thing","console","log","document","getElementById","addEventListener","removeEventListener","db","firestore","votesListener","collection","where","viewedPost","pid","onSnapshot","snapshot","docs","forEach","vote","data","value","voterID","myUID","postSelected","voteContainerEntered","showLikerDelay","window","setTimeout","voteContainerLeft","voterEntered","voterLeft","pointsPercentage","Math","floor","iconStyle","iconColor","liker","mapStatetoProps","state","uid"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport firebase from 'firebase'\nimport 'firebase/firestore'\n\n\nimport './PostLikes.css'\n\nconst PostLikes = (props) => {\n\n    // data\n    const [points, setPoints] = useState(0);\n    const [likes, setLikes] = useState(0)\n    const [dislikes, setDislikes] = useState(0)\n    const [myVote, setMyVote] = useState({})\n\n    // show likes\n    const [showLiker, setShowLiker] = useState(false)\n\n    // timeouts\n    const [showLikerTimeout, setShowLikerTimeout] = useState(null)\n    const [hideLikerTimeout, setHideLikerTimeout] = useState(null)\n\n    // mouse states\n    const [isInsideVoteButton, setIsInsideVoteButton] = useState(false)\n    const [isInsideVoter, setIsInsideVoter] = useState(false)\n\n\n\n\n    useEffect(() => {\n        const thing = () => console.log('entered!!!')\n        document.getElementById('vote-icon').addEventListener('mouseenter', thing)\n        return () => {\n            document.getElementById('vote-icon').removeEventListener('mouseenter', thing)\n        };\n    }, [])\n\n\n    useEffect(() => {\n\n        const db = firebase.firestore()\n        const votesListener = db.collection('postVotes').where('pid', '==', props.viewedPost.pid).onSnapshot(snapshot => {\n            var points = 0\n            var likes = 0\n            var dislikes = 0\n            var myVote = null;\n            // for every vote of this post\n            snapshot.docs.forEach(vote => {\n                vote = vote.data()\n                if (vote.value === 1) {\n                    likes += 1\n                }\n                if (vote.value === -1) {\n                    dislikes += 1\n                }\n                if (vote.voterID === props.myUID) {\n                    myVote = vote\n                }\n            })\n            points = (likes - dislikes) < 0 ? 0 : (likes - dislikes)\n            setPoints(points)\n            setLikes(likes)\n            setDislikes(dislikes)\n            setMyVote(myVote)\n        })\n        return () => {\n            votesListener()\n        };\n    }, [props.myUID, props.postSelected, props.viewedPost]);\n\n\n\n    \n\n    // vote container\n    const voteContainerEntered = () => {\n        setIsInsideVoteButton(true)\n        var showLikerDelay = window.setTimeout(() => {\n            setShowLiker(true)\n        }, 1000)\n        setShowLikerTimeout(showLikerDelay)\n    }\n    const voteContainerLeft = () => {\n        setIsInsideVoteButton(false)\n    }\n\n    //pop-up voter\n    const voterEntered = () => {\n        setIsInsideVoter(true)\n        \n    }\n    const voterLeft = () => {\n        setIsInsideVoter(false)\n        // if (!isInsideVoter) {\n        //     window.clearTimeout(showLikerTimeout)\n        // }\n    }\n\n    // render ~~~~~~~~~~~~~\n\n\n    const pointsPercentage = likes > 0 ? Math.floor((likes * 1.0) / (likes + dislikes * 1.0) * 100) : null\n\n    var iconStyle = 'fire'\n    var iconColor = myVote.value ? 'lit' : ''\n    if (myVote.value === -1) {\n        iconStyle = 'trash'\n    }\n\n    const liker = (\n        <div\n            className={`likes__pop-up-voter-container`}\n            onMouseEnter={voterEntered}\n            onMouseLeave={voterLeft}>\n            <div className={`pop-up-voter-container__pop-up-voter`}>\n            </div>\n        </div>\n    )\n\n    return (\n        <div className='likes'>\n            {showLiker ? liker : null}\n            <div\n                className={`vote-icon-container`}\n                id={`vote-icon`}\n                onMouseEnter={voteContainerEntered}\n                onMouseLeave={voteContainerLeft}>\n                <i\n                    className={`fas fa-${iconStyle} vote-icon-container__${iconStyle} ${iconColor}`}\n                />\n            </div>\n            <div className='total-score'>\n                {points} pt{points === 1 ? null : 's'}. {pointsPercentage ? '(' + pointsPercentage + '%)' : null}\n            </div>\n            <div className='fans'>\n                {likes} {likes === 1 ? 'like' : 'likes'}\n            </div>\n\n        </div>\n    )\n}\n\nconst mapStatetoProps = state => {\n    return {\n        myUID: state.uid\n    }\n}\n\nexport default connect(mapStatetoProps, null)(PostLikes)\n"]},"metadata":{},"sourceType":"module"}