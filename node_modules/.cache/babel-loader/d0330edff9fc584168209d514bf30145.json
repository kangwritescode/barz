{"ast":null,"code":"import _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/containers/Landing/RegForm/RegForm.js\";\nimport React, { useState, useEffect } from 'react';\nimport validator from 'validator';\nimport firebase from 'firebase';\nimport './RegForm.css';\nimport axios from 'axios';\n\nfunction RegForm(props) {\n  //state\n  var _useState = useState('profile'),\n      _useState2 = _slicedToArray(_useState, 2),\n      step = _useState2[0],\n      setStep = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      email = _useState4[0],\n      setEmail = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      password = _useState6[0],\n      setPass = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      username = _useState8[0],\n      setUsername = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      zipcode = _useState10[0],\n      setZipcode = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      gender = _useState12[0],\n      pickGender = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      allEmails = _useState14[0],\n      setAllEmails = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      allUsernames = _useState16[0],\n      setAllUsernames = _useState16[1]; // on mounting\n\n\n  useEffect(() => {\n    fetchEmailsAndUsernames();\n  }, []); // fetch emails\n\n  const fetchEmailsAndUsernames = async () => {\n    const db = firebase.firestore();\n    var emailsAndUsernames = await db.collection('users').get().then(snapshots => {\n      var emails = [];\n      var usernames = [];\n      snapshots.forEach(snapshot => {\n        emails.push(snapshot.data().email);\n        usernames.push(snapshot.data().username);\n      });\n      return [emails, usernames];\n    });\n    setAllEmails(emailsAndUsernames[0]);\n    setAllUsernames(emailsAndUsernames[1]);\n  };\n\n  const fetchAddressFromZipcode = zipcode => {\n    return axios.get('https://www.zipcodeapi.com/rest/js-zF10dQxfazt7cMgYnzZphQk7jEzBwBYPb781ubkqZokAXEvUzbinxdGT5rzVrkmB/info.json/' + zipcode + '/degrees').then(res => {\n      return res.data;\n    }).catch(err => {\n      throw this.errorCreater(\"Sorry, we're having issues processing that zipcode.\");\n    });\n  }; // filter functions\n\n\n  const filterAndSetUsername = value => {\n    const regex = new RegExp(/^[A-Za-z0-9_]+$/);\n\n    if (regex.test(value) || value === '') {\n      setUsername(value);\n    } else {\n      return;\n    }\n  };\n\n  const filterAndSetZipcode = value => {\n    if (value.length <= 5) {\n      setZipcode(value);\n    }\n  }; // validate functions\n\n\n  const validateEmail = email => {\n    if (!validator.isEmail(email)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const validatePassword = password => {\n    if (password.length < 6) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const validateUsername = username => {\n    if (username.length < 3) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const validateZipcode = zipcode => {\n    var zipString = parseInt(zipcode);\n    var zipCodePattern = /^\\d{5}$|^\\d{5}-\\d{4}$/;\n    return zipCodePattern.test(zipString);\n  }; // auth functions\n\n\n  const firstStep = () => {\n    if (allEmails.includes(email)) {\n      props.setErrMsg('An account with that email already exists.');\n      props.setShowErr(true);\n    } else {\n      setStep('profile');\n    }\n  };\n\n  const submit = async event => {\n    event.preventDefault();\n\n    if (allUsernames.includes(username)) {\n      notifyWithErr('That username is taken.');\n      return;\n    }\n  };\n\n  const notifyWithErr = msg => {\n    props.setErrMsg(msg);\n    props.setShowErr(true);\n  }; // validate values (account)\n\n\n  const isInvalidEmail = email && !validateEmail(email) ? 'invalid' : null;\n  const isInvalidPass = password && !validatePassword(password) ? 'invalid' : null;\n  const isValidContinue = email && password && !isInvalidEmail && !isInvalidPass ? 'valid' : null; // validate values (profile)\n\n  const isInvalidUsername = username && !validateUsername(username) ? 'invalid' : null;\n  const isInvalidZipcode = zipcode && !validateZipcode(zipcode) ? 'invalid' : null;\n  const maleSelected = gender === 'male' ? 'focused-sex' : null;\n  const femaleSelected = gender === 'female' ? 'focused-sex' : null;\n  const isValidSubmit = username && zipcode && gender && validateUsername(username) && validateZipcode(zipcode) ? 'valid' : null; // form\n\n  var form = React.createElement(\"div\", {\n    className: \"account-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"reg-detail\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, \"Account Info\"), React.createElement(\"input\", {\n    className: \"large-input \".concat(isInvalidEmail),\n    placeholder: \"Email\",\n    value: email,\n    onInput: event => setEmail(event.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    className: \"large-input \".concat(isInvalidPass),\n    type: \"password\",\n    value: password,\n    placeholder: \"Password\",\n    onInput: event => setPass(event.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    className: \"reg-button \".concat(isValidContinue),\n    onClick: event => {\n      event.preventDefault();\n      firstStep();\n    },\n    disabled: !isValidContinue,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, \"Continue\"));\n  console.log(isInvalidUsername);\n\n  if (step === 'profile') {\n    form = React.createElement(\"div\", {\n      className: \"profile-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"reg-detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"Profile Info\"), React.createElement(\"input\", {\n      className: \"large-input \".concat(isInvalidUsername),\n      placeholder: \"Username\",\n      value: username,\n      maxLength: 15,\n      onChange: event => filterAndSetUsername(event.target.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"zip-sex-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"number\",\n      className: \"zip-input \".concat(isInvalidZipcode),\n      placeholder: \"Hometown ZIP\",\n      value: zipcode,\n      onChange: event => filterAndSetZipcode(event.target.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"sex-button \".concat(maleSelected),\n      onClick: event => {\n        event.preventDefault();\n        pickGender('male');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, \"M\"), React.createElement(\"button\", {\n      className: \"sex-button \".concat(femaleSelected),\n      onClick: event => {\n        event.preventDefault();\n        pickGender('female');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"F\")), React.createElement(\"button\", {\n      className: \"reg-button \".concat(isValidSubmit),\n      onClick: event => submit(event),\n      disabled: !isValidSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Submit\"));\n  }\n\n  return React.createElement(\"form\", {\n    className: \"reg-form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fa fa-close\",\n    id: \"reg-form-close\",\n    onClick: () => props.updateReg(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }), React.createElement(\"h1\", {\n    className: \"reg-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, \"Sign Up\"), form);\n}\n\nexport default RegForm;","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/containers/Landing/RegForm/RegForm.js"],"names":["React","useState","useEffect","validator","firebase","axios","RegForm","props","step","setStep","email","setEmail","password","setPass","username","setUsername","zipcode","setZipcode","gender","pickGender","allEmails","setAllEmails","allUsernames","setAllUsernames","fetchEmailsAndUsernames","db","firestore","emailsAndUsernames","collection","get","then","snapshots","emails","usernames","forEach","snapshot","push","data","fetchAddressFromZipcode","res","catch","err","errorCreater","filterAndSetUsername","value","regex","RegExp","test","filterAndSetZipcode","length","validateEmail","isEmail","validatePassword","validateUsername","validateZipcode","zipString","parseInt","zipCodePattern","firstStep","includes","setErrMsg","setShowErr","submit","event","preventDefault","notifyWithErr","msg","isInvalidEmail","isInvalidPass","isValidContinue","isInvalidUsername","isInvalidZipcode","maleSelected","femaleSelected","isValidSubmit","form","target","console","log","updateReg"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport validator from 'validator'\nimport firebase from 'firebase'\nimport './RegForm.css'\nimport axios from 'axios'\n\nfunction RegForm(props) {\n\n    //state\n    var [step, setStep] = useState('profile')\n\n    var [email, setEmail] = useState('')\n    var [password, setPass] = useState('')\n    var [username, setUsername] = useState('')\n    var [zipcode, setZipcode] = useState('')\n    var [gender, pickGender] = useState(null)\n\n    var [allEmails, setAllEmails] = useState([])\n    var [allUsernames, setAllUsernames] = useState([])\n\n    // on mounting\n    useEffect(() => {\n        fetchEmailsAndUsernames()\n    }, [])\n\n    // fetch emails\n    const fetchEmailsAndUsernames = async () => {\n        const db = firebase.firestore()\n        var emailsAndUsernames = await db.collection('users').get()\n            .then(snapshots => {\n                var emails = []\n                var usernames = []\n                snapshots.forEach(snapshot => {\n                    emails.push(snapshot.data().email)\n                    usernames.push(snapshot.data().username)\n                })\n                return [emails, usernames]\n            })\n        setAllEmails(emailsAndUsernames[0])\n        setAllUsernames(emailsAndUsernames[1])\n    }\n\n    const fetchAddressFromZipcode = (zipcode) => {\n        return axios.get('https://www.zipcodeapi.com/rest/js-zF10dQxfazt7cMgYnzZphQk7jEzBwBYPb781ubkqZokAXEvUzbinxdGT5rzVrkmB/info.json/' + zipcode + '/degrees')\n            .then(res => { return res.data })\n            .catch(err => {\n                throw this.errorCreater(\"Sorry, we're having issues processing that zipcode.\")\n            })\n    }\n\n\n    // filter functions\n    const filterAndSetUsername = (value) => {\n        const regex = new RegExp(/^[A-Za-z0-9_]+$/)\n        if (regex.test(value) || value === '') {\n            setUsername(value)\n        } else {\n            return\n        }\n    }\n\n    const filterAndSetZipcode = (value) => {\n        if (value.length <= 5) {\n            setZipcode(value)\n        }\n    }\n\n    // validate functions\n    const validateEmail = (email) => {\n        if (!validator.isEmail(email)) {\n            return false\n        }\n        return true\n    }\n    const validatePassword = (password) => {\n        if (password.length < 6) {\n            return false\n        }\n        return true\n    }\n    const validateUsername = (username) => {\n        if (username.length < 3) {\n            return false\n        }\n        return true\n    }\n\n    const validateZipcode = (zipcode) => {\n        var zipString = parseInt(zipcode)\n        var zipCodePattern = /^\\d{5}$|^\\d{5}-\\d{4}$/;\n        return zipCodePattern.test(zipString);\n    }\n\n    // auth functions\n    const firstStep = () => {\n        if (allEmails.includes(email)) {\n            props.setErrMsg('An account with that email already exists.')\n            props.setShowErr(true)\n        } else {\n            setStep('profile')\n        }\n    }\n    const submit = async (event) => {\n        event.preventDefault()\n        if (allUsernames.includes(username)) {\n            notifyWithErr('That username is taken.')\n            return\n        }\n\n\n\n    }\n    const notifyWithErr = (msg) => {\n        props.setErrMsg(msg)\n        props.setShowErr(true)\n    }\n\n    // validate values (account)\n    const isInvalidEmail = email && !validateEmail(email) ? 'invalid' : null\n    const isInvalidPass = password && !validatePassword(password) ? 'invalid' : null\n    const isValidContinue = email && password && !isInvalidEmail && !isInvalidPass ? 'valid' : null\n\n\n    // validate values (profile)\n    const isInvalidUsername = username && !validateUsername(username) ? 'invalid' : null\n    const isInvalidZipcode = zipcode && !validateZipcode(zipcode) ? 'invalid' : null\n    const maleSelected = gender === 'male' ? 'focused-sex' : null\n    const femaleSelected = gender === 'female' ? 'focused-sex' : null\n    const isValidSubmit = (\n        username &&\n        zipcode &&\n        gender &&\n        validateUsername(username) &&\n        validateZipcode(zipcode)\n    ) ? 'valid' : null\n\n\n    // form\n    var form = (\n        <div className='account-wrapper'>\n            <div className='reg-detail'>Account Info</div>\n            <input\n                className={`large-input ${isInvalidEmail}`}\n                placeholder='Email'\n                value={email}\n                onInput={event => setEmail(event.target.value)}></input>\n            <input\n                className={`large-input ${isInvalidPass}`}\n                type='password'\n                value={password}\n                placeholder='Password'\n                onInput={event => setPass(event.target.value)}></input>\n            <button\n                className={`reg-button ${isValidContinue}`}\n                onClick={(event) => {\n                    event.preventDefault();\n                    firstStep()\n                }}\n                disabled={!isValidContinue}>Continue</button>\n        </div>\n\n    )\n    console.log(isInvalidUsername)\n    if (step === 'profile') {\n        form = (\n            <div className='profile-wrapper'>\n                <div className='reg-detail'>Profile Info</div>\n                <input\n                    className={`large-input ${isInvalidUsername}`}\n                    placeholder='Username'\n                    value={username}\n                    maxLength={15}\n                    onChange={event => filterAndSetUsername(event.target.value)}></input>\n                <div className='zip-sex-wrapper'>\n                    <input\n                        type='number'\n                        className={`zip-input ${isInvalidZipcode}`}\n                        placeholder='Hometown ZIP'\n                        value={zipcode}\n                        onChange={event => filterAndSetZipcode(event.target.value)}></input>\n                    <button className={`sex-button ${maleSelected}`} onClick={(event) => { event.preventDefault(); pickGender('male') }}>M</button>\n                    <button className={`sex-button ${femaleSelected}`} onClick={(event) => { event.preventDefault(); pickGender('female') }}>F</button>\n                </div>\n                <button\n                    className={`reg-button ${isValidSubmit}`}\n                    onClick={event => submit(event)}\n                    disabled={!isValidSubmit}>Submit</button>\n            </div>\n        )\n    }\n    return (\n        <form className='reg-form'>\n            <i className=\"fa fa-close\" id='reg-form-close' onClick={() => props.updateReg(false)}></i>\n            <h1 className='reg-header'>Sign Up</h1>\n            {form}\n        </form>\n    )\n}\n\nexport default RegForm\n"]},"metadata":{},"sourceType":"module"}