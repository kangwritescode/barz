{"ast":null,"code":"import _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/MyBars.js\";\nimport React, { Component, useState, useEffect } from 'react';\nimport firebase from '../../../Firebase';\nimport { connect } from 'react-redux';\nimport 'firebase/firestore';\nimport './MyBars.css';\nimport ViewedPost from './ViewedBar/ViewedPost';\nimport GenID from '../../../shared/GenID';\nimport FireApi from '../../../FireApi/FireApi';\n\nconst MyBars = props => {\n  const monthString = {\n    '1': 'January',\n    '2': 'February',\n    '3': 'March',\n    '4': 'April',\n    '5': 'May',\n    '6': 'June',\n    '7': 'July',\n    '8': 'August',\n    '9': 'September',\n    '10': 'October',\n    '11': 'November',\n    '12': 'December'\n  };\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        posts = _useState2[0],\n        setPosts = _useState2[1];\n\n  const _useState3 = useState([]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        votes = _useState4[0],\n        setVotes = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        showPost = _useState6[0],\n        setShowPost = _useState6[1];\n\n  const _useState7 = useState(null),\n        _useState8 = _slicedToArray(_useState7, 2),\n        viewedPost = _useState8[0],\n        setViewedPost = _useState8[1];\n\n  useEffect(() => {\n    if (props.myUID) {\n      const fetchVotesForUIDListener = FireApi.voteForUIDListener(setVotes, props.myUID);\n      const userSortedPostsListener = FireApi.userSortedPostsListener(setPosts, props.myUID);\n      return () => {\n        fetchVotesForUIDListener();\n        userSortedPostsListener();\n      };\n    }\n  }, [props.myUID]);\n\n  const getOrdinal = i => {\n    var j = i % 10;\n    var k = i % 100;\n\n    if (j == 1 && k != 11) {\n      return \"st\";\n    }\n\n    if (j == 2 && k != 12) {\n      return \"nd\";\n    }\n\n    if (j == 3 && k != 13) {\n      return \"rd\";\n    } else {\n      return \"th\";\n    }\n  };\n\n  const insertDateHeaders = inputArr => {\n    // create a copy\n    var arr = [...inputArr];\n    var currYear = 0;\n    var currMonth = 0;\n    var i = 0;\n\n    while (i < arr.length) {\n      var postYear = arr[i].createdOn.toDate().getUTCFullYear();\n      var postMonth = arr[i].createdOn.toDate().getUTCMonth() + 1; // if a new year is introduced, update\n\n      if (postYear !== currYear) {\n        currYear = postYear;\n      } // if a new month is introduced, or the same month but different year\n\n\n      if (postMonth !== currMonth || postMonth == currMonth && currYear != postYear) {\n        arr.splice(i, 0, [postMonth, currYear]);\n        currMonth = postMonth;\n        i += 1;\n      } else {\n        i += 1;\n      }\n    } // return copy with inserted variables\n\n\n    return arr;\n  };\n\n  const toggleModal = (modal, value) => {\n    setShowPost(value);\n  };\n\n  const viewPost = pid => {\n    setShowPost(true);\n    setViewedPost(pid);\n  }; // UI\n\n\n  let focused = this.props.focused === \"MyBars\";\n  let myBarsId = focused ? 'mybars-expanded' : 'mybars-compressed';\n  let widgetHeader = focused ? 'my-bars-header-compressed' : 'my-bars-header-expanded';\n  let postsContainerId = focused ? 'posts-container-opaque' : 'posts-container-transparent'; // insert the date headers into the array\n\n  var preppedPosts = this.insertDateHeaders(posts);\n  return React.createElement(\"div\", {\n    className: \"my-bars\",\n    id: myBarsId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"my-bars-widget-header\",\n    id: widgetHeader,\n    onClick: !focused ? this.props.toggle : null,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, \"Manage\"), React.createElement(\"div\", {\n    className: \"posts-container\",\n    id: postsContainerId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, preppedPosts.map(post => {\n    if (typeof post === 'array' || post instanceof Array) {\n      return React.createElement(\"div\", {\n        id: \"month-header\",\n        key: GenID(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, MyBars.monthString[post[0]], \" \", post[1]);\n    }\n\n    return React.createElement(\"div\", {\n      className: \"a-post\",\n      onClick: () => this.viewPost(post.pid),\n      key: GenID(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"likes-overlay\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-fire\",\n      id: \"my-bars-flame\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    })), votes[post.pid] > 0 ? [post.pid] : 0), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, post.content.lineOne + \"...\"));\n  })), this.state.showPost ? React.createElement(ViewedPost, {\n    toggleViewedPost: this.toggleModal,\n    pid: this.state.viewedPost,\n    toggleModal: this.toggleModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }) : null);\n};\n\nconst mapStateToProps = state => {\n  return {\n    myUID: state.uid\n  };\n};\n\nexport default connect(mapStateToProps, null)(MyBars);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/MyBars.js"],"names":["React","Component","useState","useEffect","firebase","connect","ViewedPost","GenID","FireApi","MyBars","props","monthString","posts","setPosts","votes","setVotes","showPost","setShowPost","viewedPost","setViewedPost","myUID","fetchVotesForUIDListener","voteForUIDListener","userSortedPostsListener","getOrdinal","i","j","k","insertDateHeaders","inputArr","arr","currYear","currMonth","length","postYear","createdOn","toDate","getUTCFullYear","postMonth","getUTCMonth","splice","toggleModal","modal","value","viewPost","pid","focused","myBarsId","widgetHeader","postsContainerId","preppedPosts","toggle","map","post","Array","content","lineOne","state","mapStateToProps","uid"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from 'react'\nimport firebase from '../../../Firebase'\nimport { connect } from 'react-redux'\nimport 'firebase/firestore'\nimport './MyBars.css'\nimport ViewedPost from './ViewedBar/ViewedPost'\nimport GenID from '../../../shared/GenID'\nimport FireApi from '../../../FireApi/FireApi'\n\n\nconst MyBars = (props) => {\n\n    const monthString = {\n        '1': 'January',\n        '2': 'February',\n        '3': 'March',\n        '4': 'April',\n        '5': 'May',\n        '6': 'June',\n        '7': 'July',\n        '8': 'August',\n        '9': 'September',\n        '10': 'October',\n        '11': 'November',\n        '12': 'December'\n    }\n\n    const [posts, setPosts] = useState([])\n    const [votes, setVotes] = useState([])\n    const [showPost, setShowPost] = useState(false)\n    const [viewedPost, setViewedPost] = useState(null)\n\n    useEffect(() => {\n        if (props.myUID) {\n            const fetchVotesForUIDListener = FireApi.voteForUIDListener(setVotes, props.myUID)\n            const userSortedPostsListener = FireApi.userSortedPostsListener(setPosts, props.myUID)\n            return () => {\n                fetchVotesForUIDListener()\n                userSortedPostsListener()\n            };\n        }\n\n    }, [props.myUID])\n\n    const getOrdinal = (i) => {\n        var j = i % 10\n        var k = i % 100\n        if (j == 1 && k != 11) { return \"st\" }\n        if (j == 2 && k != 12) { return \"nd\" }\n        if (j == 3 && k != 13) { return \"rd\" }\n        else { return \"th\" }\n    }\n\n    const insertDateHeaders = (inputArr) => {\n        // create a copy\n        var arr = [...inputArr]\n        var currYear = 0\n        var currMonth = 0\n        var i = 0\n        while (i < arr.length) {\n            var postYear = arr[i].createdOn.toDate().getUTCFullYear()\n            var postMonth = arr[i].createdOn.toDate().getUTCMonth() + 1\n\n            // if a new year is introduced, update\n            if (postYear !== currYear) {\n                currYear = postYear\n            }\n            // if a new month is introduced, or the same month but different year\n            if (postMonth !== currMonth || postMonth == currMonth && currYear != postYear) {\n                arr.splice(i, 0, [postMonth, currYear])\n                currMonth = postMonth\n                i += 1\n            } else {\n                i += 1\n            }\n        }\n        // return copy with inserted variables\n        return arr\n    }\n\n    const toggleModal = (modal, value) => {\n        setShowPost(value)\n    }\n\n    const viewPost = (pid) => {\n        setShowPost(true)\n        setViewedPost(pid)\n    }\n\n\n\n    // UI\n    let focused = this.props.focused === \"MyBars\"\n    let myBarsId = focused ? 'mybars-expanded' : 'mybars-compressed'\n    let widgetHeader = focused ? 'my-bars-header-compressed' : 'my-bars-header-expanded'\n    let postsContainerId = focused ? 'posts-container-opaque' : 'posts-container-transparent'\n\n    // insert the date headers into the array\n\n    var preppedPosts = this.insertDateHeaders(posts)\n\n    return (\n        <div className=\"my-bars\" id={myBarsId}>\n            <div className={`my-bars-widget-header`} id={widgetHeader} onClick={!focused ? this.props.toggle : null}>Manage</div>\n            <div className=\"posts-container\" id={postsContainerId}>\n                {preppedPosts.map((post) => {\n                    if ((typeof post === 'array' || post instanceof Array)) {\n                        return <div id='month-header' key={GenID()}>{MyBars.monthString[post[0]]} {post[1]}</div>\n                    }\n                    return (\n                        <div className=\"a-post\" onClick={() => this.viewPost(post.pid)} key={GenID()}>\n                            <div id='likes-overlay'>\n                                <span><i className=\"fas fa-fire\" id=\"my-bars-flame\"></i></span>\n                                {votes[post.pid] > 0 ? [post.pid] : 0}\n                            </div>\n                            <p>{post.content.lineOne + \"...\"}</p>\n                        </div>\n                    )\n                })}\n            </div>\n            {this.state.showPost ? <ViewedPost toggleViewedPost={this.toggleModal} pid={this.state.viewedPost} toggleModal={this.toggleModal} /> : null}\n        </div>\n    )\n\n}\n\nconst mapStateToProps = state => {\n    return {\n        myUID: state.uid\n    }\n}\n\nexport default connect(mapStateToProps, null)(MyBars)\n\n"]},"metadata":{},"sourceType":"module"}