{"ast":null,"code":"import _defineProperty from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/containers/Hub/ProfileBox/HubProfileBox.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport './HubProfileBox.css';\nimport PhotoContainer from '../Profile/PhotoContainer/PhotoContainer';\nimport * as actionTypes from '../../../store/actions';\nimport firebase from 'firebase';\nimport { getOrdinal } from '../../../shared/getOrdinal';\nimport { connect } from 'react-redux';\nimport { postUserData } from '../../../store/actionCreators';\n\nfunction ProfileBox(props) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        showDropOptions = _useState2[0],\n        toggleDropOptions = _useState2[1];\n\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        imgURL = _useState4[0],\n        setImgURL = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        follows = _useState6[0],\n        setFollows = _useState6[1];\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        amFollowing = _useState8[0],\n        setAmFollowing = _useState8[1];\n\n  const _useState9 = useState(''),\n        _useState10 = _slicedToArray(_useState9, 2),\n        blurbText = _useState10[0],\n        setBlurbText = _useState10[1]; // componentDidMount\n\n\n  useEffect(() => {\n    document.addEventListener('click', closeDropOptions);\n    fetchFollows();\n    return () => {\n      document.removeEventListener('click', closeDropOptions);\n    };\n  }, []); // componentDidUpdate\n\n  useEffect(() => {\n    if (props.blurb) {\n      setBlurbText(props.blurb);\n    }\n  }, [props.photoRef, props.rapper, props.wrappedBy, follows, props.uid, props.blurb]);\n\n  const fetchFollows = async () => {\n    var db = firebase.firestore();\n    var follows = await db.collection(\"follows\").get().then(querySnapshot => {\n      var fetchedFollows = [];\n      querySnapshot.forEach(doc => {\n        fetchedFollows.push(_objectSpread({}, doc.data(), {\n          fid: doc.id\n        }));\n      });\n      return fetchedFollows;\n    });\n    setFollows(follows);\n  };\n\n  const follow = () => {\n    setAmFollowing(true);\n    var db = firebase.firestore();\n    db.collection('follows').add({\n      from: props.uid,\n      to: props.rapper.uid\n    }).then(() => fetchFollows()).catch(err => console.log(err.message));\n  };\n\n  const unfollow = () => {\n    setAmFollowing(false);\n    var db = firebase.firestore();\n    db.collection('follows').where('from', '==', props.uid).where('to', '==', props.rapper.uid).get().then(snap => {\n      snap.forEach(doc => {\n        doc.ref.delete();\n      });\n      fetchFollows();\n    }).catch(err => console.log(err));\n  };\n\n  const addhttp = url => {\n    if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n      url = \"http://\" + url;\n    }\n\n    return url;\n  };\n\n  const closeDropOptions = event => {\n    if (!event.target.classList.contains('profile-box__three-dots') && !event.target.classList.contains('dot')) {\n      toggleDropOptions(false);\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: \"profile-box\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile-box__three-dots\",\n    onClick: () => toggleDropOptions(!showDropOptions),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dot\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"dot\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"dot\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  })), showDropOptions ? React.createElement(\"div\", {\n    className: \"profile-box__drop-options\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"drop-options__log-out\",\n    onClick: props.logout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, \"Log Out\")) : null, React.createElement(\"i\", {\n    className: \"fas fa-cog profile-box__settings\",\n    onClick: () => props.toggleDeleteAcc(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"profile-box__block-one\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(PhotoContainer, {\n    imgURL: props.photoURL,\n    setShowPhotoModal: props.setShowPhotoModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"block-one__username\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, props.username), React.createElement(\"div\", {\n    className: \"block-one__address-gender\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, props.city, \", \", props.state, \" | \", props.sex), React.createElement(\"div\", {\n    className: \"block-one__handles-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fab fa-facebook-f icon\",\n    onClick: () => props.toggleUploadHandles(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }), React.createElement(\"i\", {\n    className: \"fab fa-instagram icon\",\n    onClick: () => props.toggleUploadHandles(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }), React.createElement(\"i\", {\n    className: \"fab fa-soundcloud icon\",\n    onClick: () => props.toggleUploadHandles(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }), React.createElement(\"i\", {\n    className: \"fab fa-youtube icon\",\n    onClick: () => props.toggleUploadHandles(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  })), React.createElement(\"textarea\", {\n    className: \"block-one__blurb\",\n    placeholder: \"-Write a blurb-\",\n    spellCheck: false,\n    maxLength: 55,\n    onChange: event => setBlurbText(event.target.value),\n    onBlur: event => props.postUserData(props.uid, {\n      blurb: event.target.value\n    }),\n    value: blurbText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"profile-box__block-two\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, props.myPlace + getOrdinal(props.myPlace) + \" place\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, props.myPoints + \" point\" + (props.myPoints === 1 ? '' : 's'))));\n}\n\nconst mapStateToProps = state => {\n  return {\n    uid: state.uid,\n    email: state.email,\n    username: state.username,\n    sex: state.gender,\n    address: state.address,\n    zipcode: state.address.zip_code,\n    city: state.address.city,\n    state: state.address.state,\n    needsInfo: state.needsInfo,\n    photoURL: state.photoURL,\n    blurb: state.blurb\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n    logout: () => dispatch({\n      type: actionTypes.LOG_OUT\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileBox);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/containers/Hub/ProfileBox/HubProfileBox.js"],"names":["React","useEffect","useState","PhotoContainer","actionTypes","firebase","getOrdinal","connect","postUserData","ProfileBox","props","showDropOptions","toggleDropOptions","imgURL","setImgURL","follows","setFollows","amFollowing","setAmFollowing","blurbText","setBlurbText","document","addEventListener","closeDropOptions","fetchFollows","removeEventListener","blurb","photoRef","rapper","wrappedBy","uid","db","firestore","collection","get","then","querySnapshot","fetchedFollows","forEach","doc","push","data","fid","id","follow","add","from","to","catch","err","console","log","message","unfollow","where","snap","ref","delete","addhttp","url","test","event","target","classList","contains","logout","toggleDeleteAcc","photoURL","setShowPhotoModal","username","city","state","sex","toggleUploadHandles","value","myPlace","myPoints","mapStateToProps","email","gender","address","zipcode","zip_code","needsInfo","mapDispatchToProps","dispatch","type","LOG_OUT"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAO,qBAAP;AACA,OAAOC,cAAP,MAA2B,0CAA3B;AACA,OAAO,KAAKC,WAAZ,MAA6B,wBAA7B;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,SAASC,UAAT,QAA2B,4BAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,YAAT,QAA6B,+BAA7B;;AAIA,SAASC,UAAT,CAAoBC,KAApB,EAA2B;AAAA,oBAEsBR,QAAQ,CAAC,KAAD,CAF9B;AAAA;AAAA,QAEhBS,eAFgB;AAAA,QAECC,iBAFD;;AAAA,qBAGKV,QAAQ,CAAC,IAAD,CAHb;AAAA;AAAA,QAGhBW,MAHgB;AAAA,QAGRC,SAHQ;;AAAA,qBAIOZ,QAAQ,CAAC,EAAD,CAJf;AAAA;AAAA,QAIhBa,OAJgB;AAAA,QAIPC,UAJO;;AAAA,qBAKed,QAAQ,CAAC,KAAD,CALvB;AAAA;AAAA,QAKhBe,WALgB;AAAA,QAKHC,cALG;;AAAA,qBAMWhB,QAAQ,CAAC,EAAD,CANnB;AAAA;AAAA,QAMhBiB,SANgB;AAAA,QAMLC,YANK,mBAUvB;;;AACAnB,EAAAA,SAAS,CAAC,MAAM;AACZoB,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,OAA1B,EAAmCC,gBAAnC;AACAC,IAAAA,YAAY;AACZ,WAAO,MAAM;AACTH,MAAAA,QAAQ,CAACI,mBAAT,CAA6B,OAA7B,EAAsCF,gBAAtC;AACH,KAFD;AAGH,GANQ,EAMN,EANM,CAAT,CAXuB,CAmBvB;;AACAtB,EAAAA,SAAS,CAAC,MAAM;AAEZ,QAAIS,KAAK,CAACgB,KAAV,EAAiB;AACbN,MAAAA,YAAY,CAACV,KAAK,CAACgB,KAAP,CAAZ;AACH;AACJ,GALQ,EAKN,CAAChB,KAAK,CAACiB,QAAP,EAAiBjB,KAAK,CAACkB,MAAvB,EAA+BlB,KAAK,CAACmB,SAArC,EAAgDd,OAAhD,EAAyDL,KAAK,CAACoB,GAA/D,EAAoEpB,KAAK,CAACgB,KAA1E,CALM,CAAT;;AAOA,QAAMF,YAAY,GAAG,YAAY;AAC7B,QAAIO,EAAE,GAAG1B,QAAQ,CAAC2B,SAAT,EAAT;AACA,QAAIjB,OAAO,GAAG,MAAMgB,EAAE,CAACE,UAAH,CAAc,SAAd,EAAyBC,GAAzB,GAA+BC,IAA/B,CAAsCC,aAAD,IAAmB;AACxE,UAAIC,cAAc,GAAG,EAArB;AACAD,MAAAA,aAAa,CAACE,OAAd,CAAsBC,GAAG,IAAI;AACzBF,QAAAA,cAAc,CAACG,IAAf,mBACOD,GAAG,CAACE,IAAJ,EADP;AAEIC,UAAAA,GAAG,EAAEH,GAAG,CAACI;AAFb;AAIH,OALD;AAMA,aAAON,cAAP;AACH,KATmB,CAApB;AAUArB,IAAAA,UAAU,CAACD,OAAD,CAAV;AAEH,GAdD;;AAiBA,QAAM6B,MAAM,GAAG,MAAM;AACjB1B,IAAAA,cAAc,CAAC,IAAD,CAAd;AACA,QAAIa,EAAE,GAAG1B,QAAQ,CAAC2B,SAAT,EAAT;AACAD,IAAAA,EAAE,CAACE,UAAH,CAAc,SAAd,EAAyBY,GAAzB,CAA6B;AACzBC,MAAAA,IAAI,EAAEpC,KAAK,CAACoB,GADa;AAEzBiB,MAAAA,EAAE,EAAErC,KAAK,CAACkB,MAAN,CAAaE;AAFQ,KAA7B,EAIKK,IAJL,CAIU,MAAMX,YAAY,EAJ5B,EAKKwB,KALL,CAKWC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CALlB;AAMH,GATD;;AAWA,QAAMC,QAAQ,GAAG,MAAM;AACnBnC,IAAAA,cAAc,CAAC,KAAD,CAAd;AACA,QAAIa,EAAE,GAAG1B,QAAQ,CAAC2B,SAAT,EAAT;AACAD,IAAAA,EAAE,CAACE,UAAH,CAAc,SAAd,EACKqB,KADL,CACW,MADX,EACmB,IADnB,EACyB5C,KAAK,CAACoB,GAD/B,EAEKwB,KAFL,CAEW,IAFX,EAEiB,IAFjB,EAEuB5C,KAAK,CAACkB,MAAN,CAAaE,GAFpC,EAGKI,GAHL,GAIKC,IAJL,CAIUoB,IAAI,IAAI;AACVA,MAAAA,IAAI,CAACjB,OAAL,CAAaC,GAAG,IAAI;AAChBA,QAAAA,GAAG,CAACiB,GAAJ,CAAQC,MAAR;AACH,OAFD;AAGAjC,MAAAA,YAAY;AACf,KATL,EAUKwB,KAVL,CAUWC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAVlB;AAWH,GAdD;;AAgBA,QAAMS,OAAO,GAAIC,GAAD,IAAS;AACrB,QAAI,CAAC,sBAAsBC,IAAtB,CAA2BD,GAA3B,CAAL,EAAsC;AAClCA,MAAAA,GAAG,GAAG,YAAYA,GAAlB;AACH;;AACD,WAAOA,GAAP;AACH,GALD;;AAOA,QAAMpC,gBAAgB,GAAIsC,KAAD,IAAW;AAChC,QAAI,CAACA,KAAK,CAACC,MAAN,CAAaC,SAAb,CAAuBC,QAAvB,CAAgC,yBAAhC,CAAD,IAA+D,CAACH,KAAK,CAACC,MAAN,CAAaC,SAAb,CAAuBC,QAAvB,CAAgC,KAAhC,CAApE,EAA4G;AACxGpD,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACH;AACJ,GAJD;;AASA,SAAQ;AAAK,IAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,yBAAf;AAAyC,IAAA,OAAO,EAAE,MAAMA,iBAAiB,CAAC,CAACD,eAAF,CAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,CADJ,EAMKA,eAAe,GACZ;AAAK,IAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAuC,IAAA,OAAO,EAAED,KAAK,CAACuD,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADJ,CADY,GAGH,IATjB,EAWI;AAAG,IAAA,SAAS,EAAC,kCAAb;AAAgD,IAAA,OAAO,EAAE,MAAMvD,KAAK,CAACwD,eAAN,CAAsB,IAAtB,CAA/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXJ,CAFI,EAeJ;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,cAAD;AAAgB,IAAA,MAAM,EAAExD,KAAK,CAACyD,QAA9B;AAAwC,IAAA,iBAAiB,EAAEzD,KAAK,CAAC0D,iBAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAsC1D,KAAK,CAAC2D,QAA5C,CAFJ,EAGI;AAAK,IAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA4C3D,KAAK,CAAC4D,IAAlD,QAA0D5D,KAAK,CAAC6D,KAAhE,SAA0E7D,KAAK,CAAC8D,GAAhF,CAHJ,EAII;AAAK,IAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAG,IAAA,SAAS,EAAC,wBAAb;AAAsC,IAAA,OAAO,EAAE,MAAM9D,KAAK,CAAC+D,mBAAN,CAA0B,IAA1B,CAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI;AAAG,IAAA,SAAS,EAAC,uBAAb;AAAqC,IAAA,OAAO,EAAE,MAAM/D,KAAK,CAAC+D,mBAAN,CAA0B,IAA1B,CAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI;AAAG,IAAA,SAAS,EAAC,wBAAb;AAAsC,IAAA,OAAO,EAAE,MAAM/D,KAAK,CAAC+D,mBAAN,CAA0B,IAA1B,CAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,EAII;AAAG,IAAA,SAAS,EAAC,qBAAb;AAAmC,IAAA,OAAO,EAAE,MAAM/D,KAAK,CAAC+D,mBAAN,CAA0B,IAA1B,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,CAJJ,EAUI;AACI,IAAA,SAAS,EAAC,kBADd;AAEI,IAAA,WAAW,EAAC,iBAFhB;AAGI,IAAA,UAAU,EAAE,KAHhB;AAII,IAAA,SAAS,EAAE,EAJf;AAKI,IAAA,QAAQ,EAAEZ,KAAK,IAAIzC,YAAY,CAACyC,KAAK,CAACC,MAAN,CAAaY,KAAd,CALnC;AAMI,IAAA,MAAM,EAAEb,KAAK,IAAInD,KAAK,CAACF,YAAN,CAAmBE,KAAK,CAACoB,GAAzB,EAA8B;AAAEJ,MAAAA,KAAK,EAAEmC,KAAK,CAACC,MAAN,CAAaY;AAAtB,KAA9B,CANrB;AAOI,IAAA,KAAK,EAAEvD,SAPX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVJ,CAfI,EAkCJ;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKT,KAAK,CAACiE,OAAN,GAAgBrE,UAAU,CAACI,KAAK,CAACiE,OAAP,CAA1B,GAA4C,QADjD,CADJ,EAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKjE,KAAK,CAACkE,QAAN,GAAiB,QAAjB,IAA6BlE,KAAK,CAACkE,QAAN,KAAmB,CAAnB,GAAuB,EAAvB,GAA4B,GAAzD,CADL,CAJJ,CAlCI,CAAR;AA4CH;;AAED,MAAMC,eAAe,GAAGN,KAAK,IAAI;AAC7B,SAAO;AACHzC,IAAAA,GAAG,EAAEyC,KAAK,CAACzC,GADR;AAEHgD,IAAAA,KAAK,EAAEP,KAAK,CAACO,KAFV;AAGHT,IAAAA,QAAQ,EAAEE,KAAK,CAACF,QAHb;AAIHG,IAAAA,GAAG,EAAED,KAAK,CAACQ,MAJR;AAKHC,IAAAA,OAAO,EAAET,KAAK,CAACS,OALZ;AAMHC,IAAAA,OAAO,EAAEV,KAAK,CAACS,OAAN,CAAcE,QANpB;AAOHZ,IAAAA,IAAI,EAAEC,KAAK,CAACS,OAAN,CAAcV,IAPjB;AAQHC,IAAAA,KAAK,EAAEA,KAAK,CAACS,OAAN,CAAcT,KARlB;AASHY,IAAAA,SAAS,EAAEZ,KAAK,CAACY,SATd;AAUHhB,IAAAA,QAAQ,EAAEI,KAAK,CAACJ,QAVb;AAWHzC,IAAAA,KAAK,EAAE6C,KAAK,CAAC7C;AAXV,GAAP;AAaH,CAdD;;AAkBA,MAAM0D,kBAAkB,GAAGC,QAAQ,IAAI;AACnC,SAAO;AACH7E,IAAAA,YAAY,EAAE,CAACsB,GAAD,EAAMW,IAAN,KAAe4C,QAAQ,CAAC7E,YAAY,CAACsB,GAAD,EAAMW,IAAN,CAAb,CADlC;AAEHwB,IAAAA,MAAM,EAAE,MAAMoB,QAAQ,CAAC;AAAEC,MAAAA,IAAI,EAAElF,WAAW,CAACmF;AAApB,KAAD;AAFnB,GAAP;AAIH,CALD;;AAOA,eAAehF,OAAO,CAACsE,eAAD,EAAkBO,kBAAlB,CAAP,CAA6C3E,UAA7C,CAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport './HubProfileBox.css'\nimport PhotoContainer from '../Profile/PhotoContainer/PhotoContainer'\nimport * as actionTypes from '../../../store/actions'\nimport firebase from 'firebase'\nimport { getOrdinal } from '../../../shared/getOrdinal'\nimport { connect } from 'react-redux'\nimport { postUserData } from '../../../store/actionCreators'\n\n\n\nfunction ProfileBox(props) {\n\n    const [showDropOptions, toggleDropOptions] = useState(false)\n    const [imgURL, setImgURL] = useState(null)\n    const [follows, setFollows] = useState([])\n    const [amFollowing, setAmFollowing] = useState(false)\n    const [blurbText, setBlurbText] = useState('')\n\n\n\n    // componentDidMount\n    useEffect(() => {\n        document.addEventListener('click', closeDropOptions)\n        fetchFollows()\n        return () => {\n            document.removeEventListener('click', closeDropOptions)\n        };\n    }, [])\n\n    // componentDidUpdate\n    useEffect(() => {\n\n        if (props.blurb) {\n            setBlurbText(props.blurb)\n        }\n    }, [props.photoRef, props.rapper, props.wrappedBy, follows, props.uid, props.blurb])\n\n    const fetchFollows = async () => {\n        var db = firebase.firestore()\n        var follows = await db.collection(\"follows\").get().then(((querySnapshot) => {\n            var fetchedFollows = []\n            querySnapshot.forEach(doc => {\n                fetchedFollows.push({\n                    ...doc.data(),\n                    fid: doc.id\n                })\n            })\n            return fetchedFollows\n        }))\n        setFollows(follows)\n\n    }\n\n\n    const follow = () => {\n        setAmFollowing(true)\n        var db = firebase.firestore()\n        db.collection('follows').add({\n            from: props.uid,\n            to: props.rapper.uid\n        })\n            .then(() => fetchFollows())\n            .catch(err => console.log(err.message))\n    }\n\n    const unfollow = () => {\n        setAmFollowing(false)\n        var db = firebase.firestore()\n        db.collection('follows')\n            .where('from', '==', props.uid)\n            .where('to', '==', props.rapper.uid)\n            .get()\n            .then(snap => {\n                snap.forEach(doc => {\n                    doc.ref.delete()\n                })\n                fetchFollows()\n            })\n            .catch(err => console.log(err))\n    }\n\n    const addhttp = (url) => {\n        if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n            url = \"http://\" + url;\n        }\n        return url;\n    }\n\n    const closeDropOptions = (event) => {\n        if (!event.target.classList.contains('profile-box__three-dots') && !event.target.classList.contains('dot')) {\n            toggleDropOptions(false)\n        }\n    }\n\n\n\n\n    return (<div className='profile-box' >\n\n        <div>\n            <div className='profile-box__three-dots' onClick={() => toggleDropOptions(!showDropOptions)}>\n                <div className='dot' />\n                <div className='dot' />\n                <div className='dot' />\n            </div>\n            {showDropOptions ?\n                <div className='profile-box__drop-options'>\n                    <div className='drop-options__log-out' onClick={props.logout}>Log Out</div>\n                </div> : null}\n\n            <i className=\"fas fa-cog profile-box__settings\" onClick={() => props.toggleDeleteAcc(true)}></i>\n        </div>\n        <div className='profile-box__block-one'>\n            <PhotoContainer imgURL={props.photoURL} setShowPhotoModal={props.setShowPhotoModal} />\n            <div className='block-one__username'>{props.username}</div>\n            <div className='block-one__address-gender'>{props.city}, {props.state} | {props.sex}</div>\n            <div className='block-one__handles-container'>\n                <i className=\"fab fa-facebook-f icon\" onClick={() => props.toggleUploadHandles(true)}></i>\n                <i className=\"fab fa-instagram icon\" onClick={() => props.toggleUploadHandles(true)}></i>\n                <i className=\"fab fa-soundcloud icon\" onClick={() => props.toggleUploadHandles(true)}></i>\n                <i className=\"fab fa-youtube icon\" onClick={() => props.toggleUploadHandles(true)}></i>\n            </div>\n            <textarea\n                className='block-one__blurb'\n                placeholder='-Write a blurb-'\n                spellCheck={false}\n                maxLength={55}\n                onChange={event => setBlurbText(event.target.value)}\n                onBlur={event => props.postUserData(props.uid, { blurb: event.target.value })}\n                value={blurbText} />\n        </div>\n        <div className='profile-box__block-two'>\n            <div>\n                {props.myPlace + getOrdinal(props.myPlace) + \" place\"}\n            </div>\n            <div>\n                {props.myPoints + \" point\" + (props.myPoints === 1 ? '' : 's')}\n            </div>\n        </div>\n    </div>\n    )\n}\n\nconst mapStateToProps = state => {\n    return {\n        uid: state.uid,\n        email: state.email,\n        username: state.username,\n        sex: state.gender,\n        address: state.address,\n        zipcode: state.address.zip_code,\n        city: state.address.city,\n        state: state.address.state,\n        needsInfo: state.needsInfo,\n        photoURL: state.photoURL,\n        blurb: state.blurb\n    }\n}\n\n\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n        logout: () => dispatch({ type: actionTypes.LOG_OUT })\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileBox)\n"]},"metadata":{},"sourceType":"module"}