{"ast":null,"code":"import _defineProperty from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/containers/Wordsmiths/Rappers/Spotlight/Spotlight.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { getOrdinal } from '../../../../shared/utility';\nimport { postUserData } from '../../../../store/actions/auth';\nimport * as actions from '../../../../store/actions/index';\nimport './Spotlight.css';\n\nfunction Spotlight(props) {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        follows = _useState2[0],\n        setFollows = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        amFollowing = _useState4[0],\n        setAmFollowing = _useState4[1]; // componentDidMount\n\n\n  useEffect(() => {\n    document.addEventListener('click', closeDropOptions);\n    fetchFollows();\n    return () => {\n      document.removeEventListener('click', closeDropOptions);\n    };\n  }, []); // componentDidUpdate\n\n  useEffect(() => {\n    const calcAmFollowing = otherUID => {\n      let follow = follows.filter(follow => {\n        return follow.to === otherUID && follow.from === props.uid;\n      });\n      setAmFollowing(follow.length === 0 ? false : true);\n    };\n\n    if (props.rapper) {\n      console.log(props.rapper);\n      calcAmFollowing(props.rapper.uid);\n    }\n\n    if (props.blurb) {\n      setBlurbText(props.blurb);\n    }\n  }, [props.photoURL, props.rapper, follows, props.uid, props.blurb]);\n\n  const fetchFollows = async () => {\n    let db = firebase.firestore();\n    let follows = await db.collection(\"follows\").get().then(querySnapshot => {\n      let fetchedFollows = [];\n      querySnapshot.forEach(doc => {\n        fetchedFollows.push(_objectSpread({}, doc.data(), {\n          fid: doc.id\n        }));\n      });\n      return fetchedFollows;\n    });\n    setFollows(follows);\n  };\n\n  const follow = () => {\n    setAmFollowing(true);\n    let db = firebase.firestore();\n    db.collection('follows').add({\n      from: props.uid,\n      to: props.rapper.uid\n    }).then(() => fetchFollows()).catch(err => console.log(err.message));\n  };\n\n  const unfollow = () => {\n    setAmFollowing(false);\n    let db = firebase.firestore();\n    db.collection('follows').where('from', '==', props.uid).where('to', '==', props.rapper.uid).get().then(snap => {\n      snap.forEach(doc => {\n        doc.ref.delete();\n      });\n      fetchFollows();\n    }).catch(err => console.log(err));\n  };\n\n  const addhttp = url => {\n    if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n      url = \"http://\" + url;\n    }\n\n    return url;\n  };\n\n  const closeDropOptions = event => {\n    if (!event.target.classList.contains('spotlight__three-dots') && !event.target.classList.contains('dot')) {\n      toggleDropOptions(false);\n    }\n  };\n\n  let username = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__username\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, props.rapper ? props.rapper.username : null) : React.createElement(\"h2\", {\n    className: \"block-one__select-a-user\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"Select a User\");\n  let addressGender = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__address-gender\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, props.rapper ? props.rapper.city : null, \", \", props.rapper ? props.rapper.state : null, \" | \", props.rapper ? props.rapper.gender : null) : null;\n  let photo = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__img-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    alt: \"\",\n    src: props.rapper.photoURL,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }), props.rapper.rank === 1 ? React.createElement(\"i\", {\n    class: \"fas fa-crown crown\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }) : null, props.rapper.rank === 2 ? React.createElement(\"i\", {\n    class: \"fas fa-crown crown\",\n    style: {\n      color: 'silver'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }) : null)) : null;\n  let button = React.createElement(\"button\", {\n    className: \"follow-button\",\n    onClick: follow,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"follow\");\n\n  if (amFollowing) {\n    button = React.createElement(\"button\", {\n      className: \"follow-button\",\n      onClick: unfollow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"following\");\n  }\n\n  let handles = null;\n\n  if (props.rapper && (props.rapper.handles.facebook || props.rapper.handles.soundcloud || props.rapper.handles.instagram || props.rapper.handles.youtube)) {\n    handles = React.createElement(\"div\", {\n      className: \"block-one__handles-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, props.rapper && props.rapper.handles.facebook ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.facebook),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-facebook-f icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.instagram ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.instagram),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-instagram icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.soundcloud ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.soundcloud),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-soundcloud icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.youtube ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.youtube),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-youtube icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    })) : null);\n  }\n\n  let blurb = null;\n\n  if (props.rapper && props.rapper.blurb) {\n    blurb = React.createElement(\"p\", {\n      className: \"block-one__blurb\",\n      style: {\n        cursor: 'text'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, props.rapper ? props.rapper.blurb : null);\n  }\n\n  console.log(props.rapper);\n  return React.createElement(\"div\", {\n    className: \"spotlight\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"spotlight__block-one\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, photo, username, addressGender, handles, blurb), React.createElement(\"div\", {\n    className: \"spotlight__block-two\",\n    style: {\n      fontSize: '.7em'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, props.focus === 'them' ? button : null, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, props.rapper ? props.rapper.rank + getOrdinal(props.rapper.rank) + ' place' : null, \" \"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, props.rapper ? props.rapper.votes + (props.rapper.votes === 1 ? ' point' : ' points') : null, \" \")));\n}\n\nconst mapStateToProps = state => {\n  return {\n    uid: state.user.uid,\n    email: state.user.email,\n    username: state.user.username,\n    sex: state.user.gender,\n    address: state.user.address,\n    zipcode: state.user.address.zip_code,\n    city: state.user.address.city,\n    state: state.user.address.state,\n    needsInfo: state.user.needsInfo,\n    photoURL: state.user.photoURL,\n    blurb: state.user.blurb\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n    logout: () => dispatch(actions.logOut())\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Spotlight);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/containers/Wordsmiths/Rappers/Spotlight/Spotlight.js"],"names":["firebase","React","useEffect","useState","connect","getOrdinal","postUserData","actions","Spotlight","props","follows","setFollows","amFollowing","setAmFollowing","document","addEventListener","closeDropOptions","fetchFollows","removeEventListener","calcAmFollowing","otherUID","follow","filter","to","from","uid","length","rapper","console","log","blurb","setBlurbText","photoURL","db","firestore","collection","get","then","querySnapshot","fetchedFollows","forEach","doc","push","data","fid","id","add","catch","err","message","unfollow","where","snap","ref","delete","addhttp","url","test","event","target","classList","contains","toggleDropOptions","username","addressGender","city","state","gender","photo","rank","color","button","handles","facebook","soundcloud","instagram","youtube","cursor","fontSize","focus","votes","mapStateToProps","user","email","sex","address","zipcode","zip_code","needsInfo","mapDispatchToProps","dispatch","logout","logOut"],"mappings":"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","sourcesContent":["import firebase from 'firebase'\nimport React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport { getOrdinal } from '../../../../shared/utility'\nimport { postUserData } from '../../../../store/actions/auth'\nimport * as actions from '../../../../store/actions/index'\nimport './Spotlight.css'\n\n\n\nfunction Spotlight(props) {\n\n    const [follows, setFollows] = useState([])\n    const [amFollowing, setAmFollowing] = useState(false)\n\n\n\n    // componentDidMount\n    useEffect(() => {\n        document.addEventListener('click', closeDropOptions)\n        fetchFollows()\n        return () => {\n            document.removeEventListener('click', closeDropOptions)\n        };\n    }, [])\n\n    // componentDidUpdate\n    useEffect(() => {\n\n        const calcAmFollowing = (otherUID) => {\n\n            let follow = follows\n                .filter(follow => {\n                    return follow.to === otherUID && follow.from === props.uid\n                })\n            setAmFollowing(follow.length === 0 ? false : true)\n        }\n\n        if (props.rapper) {\n            console.log(props.rapper)\n            calcAmFollowing(props.rapper.uid)\n        }\n        if (props.blurb) {\n            setBlurbText(props.blurb)\n        }\n    }, [props.photoURL, props.rapper, follows, props.uid, props.blurb])\n\n    const fetchFollows = async () => {\n        let db = firebase.firestore()\n        let follows = await db.collection(\"follows\").get().then(((querySnapshot) => {\n            let fetchedFollows = []\n            querySnapshot.forEach(doc => {\n                fetchedFollows.push({\n                    ...doc.data(),\n                    fid: doc.id\n                })\n            })\n            return fetchedFollows\n        }))\n        setFollows(follows)\n\n    }\n\n\n    const follow = () => {\n        setAmFollowing(true)\n        let db = firebase.firestore()\n        db.collection('follows').add({\n            from: props.uid,\n            to: props.rapper.uid\n        })\n            .then(() => fetchFollows())\n            .catch(err => console.log(err.message))\n    }\n\n    const unfollow = () => {\n        setAmFollowing(false)\n        let db = firebase.firestore()\n        db.collection('follows')\n            .where('from', '==', props.uid)\n            .where('to', '==', props.rapper.uid)\n            .get()\n            .then(snap => {\n                snap.forEach(doc => {\n                    doc.ref.delete()\n                })\n                fetchFollows()\n            })\n            .catch(err => console.log(err))\n    }\n\n    const addhttp = (url) => {\n        if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n            url = \"http://\" + url;\n        }\n        return url;\n    }\n\n    const closeDropOptions = (event) => {\n        if (!event.target.classList.contains('spotlight__three-dots') && !event.target.classList.contains('dot')) {\n            toggleDropOptions(false)\n        }\n    }\n\n\n    let username = props.rapper ?\n        <div className='block-one__username'>{props.rapper ? props.rapper.username : null}</div>\n        : <h2 className='block-one__select-a-user'>Select a User</h2>\n    let addressGender = props.rapper ?\n        <div className='block-one__address-gender'>{props.rapper ? props.rapper.city : null}, {props.rapper ? props.rapper.state : null} | {props.rapper ? props.rapper.gender : null}</div>\n        : null\n\n\n    let photo = props.rapper ?\n        <div className='block-one__img-wrapper'>\n            <div>\n                <img alt='' src={props.rapper.photoURL} />\n                {props.rapper.rank === 1 ? \n                    <i class=\"fas fa-crown crown\"></i> \n                    : null}\n                {props.rapper.rank === 2 ? \n                    <i class=\"fas fa-crown crown\" style={{color: 'silver'}}></i> \n                    : null}\n                    \n            </div>\n\n        </div>\n        : null\n    let button = <button className='follow-button' onClick={follow}>follow</button>\n    if (amFollowing) {\n        button = <button className='follow-button' onClick={unfollow}>following</button>\n    }\n    let handles = null;\n\n\n    if (props.rapper && (props.rapper.handles.facebook\n        || props.rapper.handles.soundcloud\n        || props.rapper.handles.instagram\n        || props.rapper.handles.youtube)) {\n        handles = (<div className='block-one__handles-container'>\n            {props.rapper && props.rapper.handles.facebook ?\n                <a href={addhttp(props.rapper.handles.facebook)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-facebook-f icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.instagram ?\n                <a href={addhttp(props.rapper.handles.instagram)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-instagram icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.soundcloud ?\n                <a href={addhttp(props.rapper.handles.soundcloud)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-soundcloud icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.youtube ?\n                <a href={addhttp(props.rapper.handles.youtube)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-youtube icon\"></i>\n                </a> : null}\n        </div>)\n    }\n    let blurb = null;\n    if (props.rapper && props.rapper.blurb) {\n        blurb = (\n            <p className='block-one__blurb' style={{ cursor: 'text' }}>\n                    {props.rapper ? props.rapper.blurb : null}\n                </p>\n        )\n    }\n    console.log(props.rapper)\n    return (\n        <div className='spotlight' >\n            <div className='spotlight__block-one'>\n\n                {photo}\n                {username}\n                {addressGender}\n                {handles}\n                {blurb}\n            </div>\n            <div className='spotlight__block-two' style={{ fontSize: '.7em' }}>\n                {props.focus === 'them' ? button : null}\n                <div>{props.rapper ? props.rapper.rank + getOrdinal(props.rapper.rank) + ' place' : null} </div>\n                <div>{props.rapper ? props.rapper.votes + (props.rapper.votes === 1 ? ' point' : ' points') : null} </div>\n\n            </div>\n        </div>\n    )\n}\n\n\nconst mapStateToProps = state => {\n    return {\n        uid: state.user.uid,\n        email: state.user.email,\n        username: state.user.username,\n        sex: state.user.gender,\n        address: state.user.address,\n        zipcode: state.user.address.zip_code,\n        city: state.user.address.city,\n        state: state.user.address.state,\n        needsInfo: state.user.needsInfo,\n        photoURL: state.user.photoURL,\n        blurb: state.user.blurb\n    }\n}\n\n\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n        logout: () => dispatch(actions.logOut())\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Spotlight)\n"]},"metadata":{},"sourceType":"module"}