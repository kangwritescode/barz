{"ast":null,"code":"import _defineProperty from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/ViewedBar/ViewedPost.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport firebase from '../../../../Firebase';\nimport 'firebase/firestore';\nimport './ViewedPost.css';\nimport TextareaAutosize from 'react-autosize-textarea';\nimport DeletePost from './DeletePost/DeletePost';\nimport PostLikes from './PostLikes/PostLikes';\nimport PostComments from './PostComments/PostComments';\nimport DeleteComment from './DeleteComment/DeleteComment';\nimport * as actionTypes from '../../../../store/actions';\n\nclass ViewedPost extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      viewedPost: null,\n      showDropdown: false,\n      showDeleteModal: false,\n      stagedCID: '',\n      showDeleteCommentModal: false,\n      viewerIMG: 'https://firebasestorage.googleapis.com/v0/b/barz-86ae0.appspot.com/o/mysteryman%2Fmysteryman.png?alt=media&token=7b1e5a7c-ede3-46ff-a036-70636e528cd2',\n      commentInput: '',\n      comments: []\n    };\n\n    this.componentDidMount = () => {\n      document.addEventListener('click', this.toggleDropdownListener);\n      this.fetchPost(this.props.pid);\n      this.fetchComments(this.props.pid);\n      this.fetchPhotoURL();\n    };\n\n    this.componentWillUnmount = () => {\n      document.removeEventListener('click', this.toggleDropdownListener);\n    };\n\n    this.fetchPhotoURL = () => {\n      if (this.props.photoRef) {\n        var storage = firebase.storage();\n        storage.ref(this.props.photoRef).getDownloadURL().then(url => {\n          this.setState(_objectSpread({}, this.state, {\n            viewerIMG: url\n          }));\n        }).catch(function (error) {\n          console.log(\"error in Profile.js: \", error);\n        });\n      }\n    };\n\n    this.fetchComments = pid => {\n      var db = firebase.firestore();\n      db.collection('postComments').where('pid', '==', this.props.pid).orderBy('date').onSnapshot(snapshot => {\n        var comments = [];\n        snapshot.forEach(doc => {\n          var comment = _objectSpread({}, doc.data(), {\n            cid: doc.id\n          });\n\n          comments.push(comment);\n        });\n        this.setState({\n          comments: comments\n        });\n      }, err => {\n        console.log(err);\n      });\n    };\n\n    this.fetchPost = pid => {\n      // document.getElementById\n      var db = firebase.firestore();\n      db.collection('submissions').doc(pid).get().then(querySnapshot => {\n        var post = _objectSpread({}, querySnapshot.data(), {\n          pid: pid\n        });\n\n        this.setState(_objectSpread({}, this.state, {\n          viewedPost: post\n        }));\n      }).catch(err => {\n        console.log('[MyBars.js] func viewPost', err);\n      });\n    };\n\n    this.toggleDropdownListener = event => {\n      const postDropMenu = document.getElementById('post-drop-menu');\n\n      if (event.target.classList.contains('three-dots') && !postDropMenu.classList.contains('post-drop-menu-show') || event.target.classList.contains('dot') && !postDropMenu.classList.contains('post-drop-menu-show')) {\n        postDropMenu.classList.add('post-drop-menu-show');\n      } else {\n        postDropMenu.classList.remove('post-drop-menu-show');\n      }\n    };\n\n    this.countVotes = voteObj => {\n      var votes = 0;\n\n      for (let key in voteObj) {\n        votes += voteObj[key] === 1 ? 1 : 0;\n      }\n\n      return votes;\n    };\n\n    this.toggleModal = (modal, value) => {\n      console.log(modal, value);\n      this.setState(_objectSpread({}, this.state, {\n        [modal]: value\n      }));\n    };\n\n    this.toggleDeleteCommentModal = (bool, cid, wasDeleted) => {\n      this.setState(_objectSpread({}, this.state, {\n        showDeleteCommentModal: bool,\n        stagedCID: cid\n      }));\n    };\n\n    this.onChangeHandler = event => {\n      event.target.value = event.target.value.replace(/[\\r\\n\\v]+/g, '');\n      this.setState(_objectSpread({}, this.state, {\n        commentInput: event.target.value\n      }));\n    };\n\n    this.generateComment = () => {\n      return {\n        comment: this.state.commentInput,\n        uid: this.props.uid,\n        username: this.props.username,\n        pid: this.props.pid,\n        photoRef: this.props.photoRef,\n        receiverUID: this.state.viewedPost.uid,\n        receiverUsername: this.state.viewedPost.username,\n        date: new Date()\n      };\n    };\n\n    this.postComment = async event => {\n      var db = firebase.firestore();\n      event.preventDefault();\n      var comment = this.generateComment();\n      await db.collection('postComments').add(comment).then(res => console.log('commented successfully')).catch(err => console.log(err));\n      this.setState(_objectSpread({}, this.state, {\n        commentInput: ''\n      }));\n    };\n\n    this.generateDate = () => {\n      const date = this.state.viewedPost.createdOn.toDate();\n      const month = date.getMonth() + 1;\n      const day = date.getDate();\n      const year = date.getFullYear() + '';\n      return month + '.' + day + '.' + year.slice(2, 4);\n    };\n  }\n\n  render() {\n    var editable = this.state.viewedPost && this.props.uid === this.state.viewedPost.uid ? true : false;\n    var deleteOption = !editable ? null : React.createElement(\"div\", {\n      className: \"post-drop-item\",\n      id: \"delete-post\",\n      onClick: () => this.toggleModal('showDeleteModal', true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Delete\");\n    var post = React.createElement(\"div\", {\n      className: \"lds-default\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }));\n\n    if (this.state.viewedPost) {\n      var bars = '\"' + this.state.viewedPost.content.lineOne + ' / ' + this.state.viewedPost.content.lineTwo + ' / ' + this.state.viewedPost.content.lineThree + ' / ' + this.state.viewedPost.content.lineFour + '\"';\n      post = React.createElement(\"div\", {\n        id: \"four-date-likes-comments-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"cell-one\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"four-bars\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, bars, \" \", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"bars-footer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"username\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, this.state.viewedPost.username), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        className: \"date-posted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, this.generateDate()))))), React.createElement(\"div\", {\n        className: \"cell-two\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"dots-block\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"three-dots\",\n        id: \"three-dots\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"post-drop-menu\",\n        id: \"post-drop-menu\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, deleteOption, React.createElement(\"div\", {\n        className: \"post-drop-item\",\n        id: \"close-post\",\n        onClick: () => this.props.toggleModal('showPost', false),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"Close Window\")), React.createElement(\"div\", {\n        className: \"dot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"dot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"dot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"cell-two-content-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"likes-comments-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(PostComments, {\n        toggleModal: this.toggleDeleteCommentModal,\n        comments: this.state.comments,\n        viewedPost: this.state.viewedPost,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }), React.createElement(PostLikes, {\n        viewedPost: this.state.viewedPost,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        className: \"post-comment\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"img-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        alt: \"\",\n        src: this.state.viewerIMG,\n        className: \"comment-user-img\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      })), React.createElement(TextareaAutosize, {\n        onChange: this.onChangeHandler,\n        value: this.state.commentInput,\n        placeholder: \"Thoughts...\",\n        maxLength: \"200\",\n        className: \"comment-input\",\n        spellCheck: \"false\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: event => this.postComment(event),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, \"Post\"))))));\n    }\n\n    return React.createElement(\"div\", {\n      id: \"viewed-post-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"viewed-post-backdrop\",\n      onClick: () => this.props.toggleModal('showPost', false),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239\n      },\n      __self: this\n    }), this.state.showDeleteModal ? React.createElement(DeletePost, {\n      toggleViewedPost: this.props.toggleViewedPost,\n      pid: this.state.viewedPost.pid,\n      toggleModal: this.props.toggleModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }) : null, this.state.showDeleteCommentModal ? React.createElement(DeleteComment, {\n      cid: this.state.stagedCID,\n      toggleModal: this.toggleDeleteCommentModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }) : null, post);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    uid: state.uid,\n    username: state.username,\n    photoURL: state.photoURL\n  };\n};\n\nexport default connect(mapStateToProps, null)(ViewedPost);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/components/Scribble/MyBars/ViewedBar/ViewedPost.js"],"names":["React","Component","connect","firebase","TextareaAutosize","DeletePost","PostLikes","PostComments","DeleteComment","actionTypes","ViewedPost","state","viewedPost","showDropdown","showDeleteModal","stagedCID","showDeleteCommentModal","viewerIMG","commentInput","comments","componentDidMount","document","addEventListener","toggleDropdownListener","fetchPost","props","pid","fetchComments","fetchPhotoURL","componentWillUnmount","removeEventListener","photoRef","storage","ref","getDownloadURL","then","url","setState","catch","error","console","log","db","firestore","collection","where","orderBy","onSnapshot","snapshot","forEach","doc","comment","data","cid","id","push","err","get","querySnapshot","post","event","postDropMenu","getElementById","target","classList","contains","add","remove","countVotes","voteObj","votes","key","toggleModal","modal","value","toggleDeleteCommentModal","bool","wasDeleted","onChangeHandler","replace","generateComment","uid","username","receiverUID","receiverUsername","date","Date","postComment","preventDefault","res","generateDate","createdOn","toDate","month","getMonth","day","getDate","year","getFullYear","slice","render","editable","deleteOption","bars","content","lineOne","lineTwo","lineThree","lineFour","toggleViewedPost","mapStateToProps","photoURL"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport firebase from '../../../../Firebase'\nimport 'firebase/firestore'\nimport './ViewedPost.css'\nimport TextareaAutosize from 'react-autosize-textarea'\nimport DeletePost from './DeletePost/DeletePost'\nimport PostLikes from './PostLikes/PostLikes'\nimport PostComments from './PostComments/PostComments'\nimport DeleteComment from './DeleteComment/DeleteComment'\nimport * as actionTypes from '../../../../store/actions'\n\nclass ViewedPost extends Component {\n\n\n    state = {\n        viewedPost: null,\n        showDropdown: false,\n        showDeleteModal: false,\n        stagedCID: '',\n        showDeleteCommentModal: false,\n        viewerIMG: 'https://firebasestorage.googleapis.com/v0/b/barz-86ae0.appspot.com/o/mysteryman%2Fmysteryman.png?alt=media&token=7b1e5a7c-ede3-46ff-a036-70636e528cd2',\n        commentInput: '',\n        comments: []\n    }\n\n\n    componentDidMount = () => {\n        document.addEventListener('click', this.toggleDropdownListener)\n        this.fetchPost(this.props.pid)\n        this.fetchComments(this.props.pid)\n        this.fetchPhotoURL()\n    }\n    componentWillUnmount = () => {\n        document.removeEventListener('click', this.toggleDropdownListener)\n    }\n\n    fetchPhotoURL = () => {\n        if (this.props.photoRef) {\n            var storage = firebase.storage();\n            storage.ref(this.props.photoRef).getDownloadURL().then(url => {\n                this.setState({\n                    ...this.state,\n                    viewerIMG: url\n                })\n            }).catch(function (error) {\n                console.log(\"error in Profile.js: \", error)\n            });\n        }\n    }\n\n    fetchComments = (pid) => {\n        var db = firebase.firestore()\n        db.collection('postComments').where('pid', '==', this.props.pid).orderBy('date').onSnapshot(snapshot => {\n            var comments = []\n            snapshot.forEach(doc => {\n                var comment = {\n                    ...doc.data(),\n                    cid: doc.id\n                }\n                comments.push(comment)\n            })\n            this.setState({\n                comments: comments\n            })\n        }, err => {\n            console.log(err)\n        })\n    }\n\n    fetchPost = (pid) => {\n        // document.getElementById\n        var db = firebase.firestore()\n        db.collection('submissions').doc(pid).get()\n            .then(querySnapshot => {\n                var post = {\n                    ...querySnapshot.data(),\n                    pid: pid\n                }\n                this.setState({\n                    ...this.state,\n                    viewedPost: post\n                })\n            })\n            .catch(err => {\n                console.log('[MyBars.js] func viewPost', err)\n            })\n    }\n\n    toggleDropdownListener = (event) => {\n        const postDropMenu = document.getElementById('post-drop-menu')\n        if (event.target.classList.contains('three-dots') && !postDropMenu.classList.contains('post-drop-menu-show')\n            || event.target.classList.contains('dot') && !postDropMenu.classList.contains('post-drop-menu-show')) {\n\n            postDropMenu.classList.add('post-drop-menu-show')\n        } else {\n            postDropMenu.classList.remove('post-drop-menu-show')\n        }\n    }\n\n    countVotes = (voteObj) => {\n        var votes = 0\n        for (let key in voteObj) {\n            votes += voteObj[key] === 1 ? 1 : 0\n        }\n        return votes\n    }\n    toggleModal = (modal, value) => {\n        console.log(modal, value)\n        this.setState({\n            ...this.state,\n            [modal]: value\n        })\n    }\n\n\n    toggleDeleteCommentModal = (bool, cid, wasDeleted) => {\n        this.setState({\n            ...this.state,\n            showDeleteCommentModal: bool,\n            stagedCID: cid\n        })\n    }\n\n\n    onChangeHandler = event => {\n        event.target.value = event.target.value.replace(/[\\r\\n\\v]+/g, '')\n        this.setState({\n            ...this.state,\n            commentInput: event.target.value\n        })\n    }\n\n    generateComment = () => {\n\n        return {\n            comment: this.state.commentInput,\n            uid: this.props.uid,\n            username: this.props.username,\n            pid: this.props.pid,\n            photoRef: this.props.photoRef,\n            receiverUID: this.state.viewedPost.uid,\n            receiverUsername: this.state.viewedPost.username,\n            date: new Date()\n        }\n    }\n\n    postComment = async event => {\n        var db = firebase.firestore()\n        event.preventDefault()\n        var comment = this.generateComment()\n        await db.collection('postComments').add(comment)\n            .then(res => console.log('commented successfully'))\n            .catch(err => console.log(err))\n        this.setState({\n            ...this.state,\n            commentInput: ''\n        })\n\n    }\n\n    generateDate = () => {\n        const date = this.state.viewedPost.createdOn.toDate()\n        const month = date.getMonth() + 1\n        const day = date.getDate()\n        const year = date.getFullYear() + ''\n        return month + '.' + day + '.' + year.slice(2, 4)\n    }\n\n    render() {\n\n        var editable = this.state.viewedPost && (this.props.uid === this.state.viewedPost.uid) ? true : false\n        var deleteOption = !editable ? null : (\n            <div className=\"post-drop-item\" id=\"delete-post\" onClick={() => this.toggleModal('showDeleteModal', true)}>Delete</div>\n        )\n        var post = (\n            <div className=\"lds-default\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>\n        )\n        if (this.state.viewedPost) {\n            var bars = '\"' + this.state.viewedPost.content.lineOne + ' / '\n                + this.state.viewedPost.content.lineTwo + ' / '\n                + this.state.viewedPost.content.lineThree + ' / '\n                + this.state.viewedPost.content.lineFour + '\"'\n            post = (\n                <div id='four-date-likes-comments-wrapper'>\n                    <div className='cell-one'>\n                        <div id=\"four-bars\">\n                            <p>\n                                {bars} <br />\n                                <div className='bars-footer'>\n                                    <span className='username'>{this.state.viewedPost.username}</span>\n                                    <br />\n                                    <span className='date-posted'>{this.generateDate()}</span>\n                                </div>\n                            </p>\n                        </div>\n                    </div>\n                    <div className='cell-two'>\n                        <div className='dots-block'>\n                            <div className='three-dots' id='three-dots'>\n                                <div className=\"post-drop-menu\" id=\"post-drop-menu\">\n                                    {deleteOption}\n                                    <div className=\"post-drop-item\" id=\"close-post\" onClick={() => this.props.toggleModal('showPost', false)}>Close Window</div>\n                                </div>\n                                <div className='dot'></div>\n                                <div className='dot'></div>\n                                <div className='dot'></div>\n                            </div>\n                        </div>\n                        <div className='cell-two-content-wrapper'>\n\n                            <div className='likes-comments-wrapper'>\n\n                                <PostComments toggleModal={this.toggleDeleteCommentModal} comments={this.state.comments} viewedPost={this.state.viewedPost} />\n                                <PostLikes viewedPost={this.state.viewedPost} />\n                                <form className='post-comment'>\n                                    <div className='img-wrapper'><img alt='' src={this.state.viewerIMG} className='comment-user-img'></img></div>\n                                    <TextareaAutosize\n                                        onChange={this.onChangeHandler}\n                                        value={this.state.commentInput}\n                                        placeholder='Thoughts...'\n                                        maxLength='200'\n                                        className='comment-input'\n                                        spellCheck=\"false\">\n                                    </TextareaAutosize>\n                                    <button onClick={event => this.postComment(event)}>Post</button>\n                                </form>\n                            </div>\n                        </div>\n\n                    </div>\n\n\n                </div>\n            )\n        }\n        return (\n            <div id='viewed-post-wrapper'>\n                <div id='viewed-post-backdrop' onClick={() => this.props.toggleModal('showPost', false)}></div>\n                {this.state.showDeleteModal ? <DeletePost toggleViewedPost={this.props.toggleViewedPost} pid={this.state.viewedPost.pid} toggleModal={this.props.toggleModal} /> : null}\n                {this.state.showDeleteCommentModal ? <DeleteComment cid={this.state.stagedCID} toggleModal={this.toggleDeleteCommentModal} /> : null}\n                {post}\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        uid: state.uid,\n        username: state.username,\n        photoURL: state.photoURL\n    }\n}\n\nexport default connect(mapStateToProps, null)(ViewedPost)\n"]},"metadata":{},"sourceType":"module"}