{"ast":null,"code":"import _defineProperty from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/containers/Wordsmiths/Rappers/Spotlight/Spotlight.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport './Spotlight.css';\nimport PhotoContainer from '../../../Hub/Profile/PhotoContainer/PhotoContainer';\nimport * as actionTypes from '../../../../store/actions';\nimport firebase from 'firebase';\nimport { getOrdinal } from '../../../../shared/getOrdinal';\nimport { connect } from 'react-redux';\nimport { postUserData } from '../../../../store/actionCreators';\n\nfunction Spotlight(props) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        showDropOptions = _useState2[0],\n        toggleDropOptions = _useState2[1];\n\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        imgURL = _useState4[0],\n        setImgURL = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        follows = _useState6[0],\n        setFollows = _useState6[1];\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        amFollowing = _useState8[0],\n        setAmFollowing = _useState8[1];\n\n  const _useState9 = useState(''),\n        _useState10 = _slicedToArray(_useState9, 2),\n        blurbText = _useState10[0],\n        setBlurbText = _useState10[1]; // componentDidMount\n\n\n  useEffect(() => {\n    document.addEventListener('click', closeDropOptions);\n    fetchFollows();\n    return () => {\n      document.removeEventListener('click', closeDropOptions);\n    };\n  }, []); // componentDidUpdate\n\n  useEffect(() => {\n    const calcAmFollowing = otherUID => {\n      var follow = follows.filter(follow => {\n        return follow.to === otherUID && follow.from === props.uid;\n      });\n      setAmFollowing(follow.length === 0 ? false : true);\n    };\n\n    if (props.rapper) {\n      console.log(props.rapper);\n      setImgURL(props.rapper.photoURL);\n      calcAmFollowing(props.rapper.uid);\n    }\n\n    if (props.blurb) {\n      setBlurbText(props.blurb);\n    }\n  }, [props.photoRef, props.rapper, follows, props.uid, props.blurb]);\n\n  const fetchFollows = async () => {\n    var db = firebase.firestore();\n    var follows = await db.collection(\"follows\").get().then(querySnapshot => {\n      var fetchedFollows = [];\n      querySnapshot.forEach(doc => {\n        fetchedFollows.push(_objectSpread({}, doc.data(), {\n          fid: doc.id\n        }));\n      });\n      return fetchedFollows;\n    });\n    setFollows(follows);\n  };\n\n  const follow = () => {\n    setAmFollowing(true);\n    var db = firebase.firestore();\n    db.collection('follows').add({\n      from: props.uid,\n      to: props.rapper.uid\n    }).then(() => fetchFollows()).catch(err => console.log(err.message));\n  };\n\n  const unfollow = () => {\n    setAmFollowing(false);\n    var db = firebase.firestore();\n    db.collection('follows').where('from', '==', props.uid).where('to', '==', props.rapper.uid).get().then(snap => {\n      snap.forEach(doc => {\n        doc.ref.delete();\n      });\n      fetchFollows();\n    }).catch(err => console.log(err));\n  };\n\n  const addhttp = url => {\n    if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n      url = \"http://\" + url;\n    }\n\n    return url;\n  };\n\n  const closeDropOptions = event => {\n    if (!event.target.classList.contains('spotlight__three-dots') && !event.target.classList.contains('dot')) {\n      toggleDropOptions(false);\n    }\n  };\n\n  var username = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__username\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, props.rapper ? props.rapper.username : null) : React.createElement(\"h2\", {\n    className: \"block-one__select-a-user\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"Select a User\");\n  var addressGender = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__address-gender\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, props.rapper ? props.rapper.city : null, \", \", props.rapper ? props.rapper.state : null, \" | \", props.rapper ? props.rapper.gender : null) : null;\n  var photo = props.rapper ? React.createElement(\"div\", {\n    className: \"block-one__img-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    alt: \"\",\n    src: imgURL,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), props.rapper.rank === 1 ? React.createElement(\"i\", {\n    class: \"fas fa-crown crown\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }) : null)) : null;\n  var button = React.createElement(\"button\", {\n    className: \"follow-button\",\n    onClick: follow,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, \"follow\");\n\n  if (amFollowing) {\n    button = React.createElement(\"button\", {\n      className: \"follow-button\",\n      onClick: unfollow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, \"following\");\n  }\n\n  var handles = null;\n\n  if (props.rapper && (props.rapper.handles.facebook || props.rapper.handles.soundcloud || props.rapper.handles.instagram || props.rapper.handles.youtube)) {\n    handles = React.createElement(\"div\", {\n      className: \"block-one__handles-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, props.rapper && props.rapper.handles.facebook ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.facebook),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-facebook-f icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.instagram ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.instagram),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-instagram icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.soundcloud ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.soundcloud),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-soundcloud icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    })) : null, props.rapper && props.rapper.handles.youtube ? React.createElement(\"a\", {\n      href: addhttp(props.rapper.handles.youtube),\n      rel: \"noopener noreferrer\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fab fa-youtube icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    })) : null);\n  }\n\n  console.log(props.rapper);\n  return React.createElement(\"div\", {\n    className: \"spotlight\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"spotlight__block-one\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, photo, username, addressGender, handles, React.createElement(\"p\", {\n    className: \"block-one__blurb\",\n    style: {\n      cursor: 'text'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, props.rapper ? props.rapper.blurb : null)), React.createElement(\"div\", {\n    className: \"spotlight__block-two\",\n    style: {\n      fontSize: '.7em'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, props.focus === 'them' ? button : null, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, props.rapper ? props.rapper.rank + getOrdinal(props.rapper.rank) + ' place' : null, \" \"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, props.rapper ? props.rapper.votes + (props.rapper.votes === 1 ? ' point' : ' points') : null, \" \")));\n}\n\nconst mapStateToProps = state => {\n  return {\n    uid: state.uid,\n    email: state.email,\n    username: state.username,\n    sex: state.gender,\n    address: state.address,\n    zipcode: state.address.zip_code,\n    city: state.address.city,\n    state: state.address.state,\n    needsInfo: state.needsInfo,\n    photoURL: state.photoURL,\n    blurb: state.blurb\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n    logout: () => dispatch({\n      type: actionTypes.LOG_OUT\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Spotlight);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/containers/Wordsmiths/Rappers/Spotlight/Spotlight.js"],"names":["React","useEffect","useState","PhotoContainer","actionTypes","firebase","getOrdinal","connect","postUserData","Spotlight","props","showDropOptions","toggleDropOptions","imgURL","setImgURL","follows","setFollows","amFollowing","setAmFollowing","blurbText","setBlurbText","document","addEventListener","closeDropOptions","fetchFollows","removeEventListener","calcAmFollowing","otherUID","follow","filter","to","from","uid","length","rapper","console","log","photoURL","blurb","photoRef","db","firestore","collection","get","then","querySnapshot","fetchedFollows","forEach","doc","push","data","fid","id","add","catch","err","message","unfollow","where","snap","ref","delete","addhttp","url","test","event","target","classList","contains","username","addressGender","city","state","gender","photo","rank","button","handles","facebook","soundcloud","instagram","youtube","cursor","fontSize","focus","votes","mapStateToProps","email","sex","address","zipcode","zip_code","needsInfo","mapDispatchToProps","dispatch","logout","type","LOG_OUT"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport './Spotlight.css'\nimport PhotoContainer from '../../../Hub/Profile/PhotoContainer/PhotoContainer'\nimport * as actionTypes from '../../../../store/actions'\nimport firebase from 'firebase'\nimport { getOrdinal } from '../../../../shared/getOrdinal'\nimport { connect } from 'react-redux'\nimport { postUserData } from '../../../../store/actionCreators'\n\n\n\nfunction Spotlight(props) {\n\n    const [showDropOptions, toggleDropOptions] = useState(false)\n    const [imgURL, setImgURL] = useState(null)\n    const [follows, setFollows] = useState([])\n    const [amFollowing, setAmFollowing] = useState(false)\n    const [blurbText, setBlurbText] = useState('')\n\n\n\n    // componentDidMount\n    useEffect(() => {\n        document.addEventListener('click', closeDropOptions)\n        fetchFollows()\n        return () => {\n            document.removeEventListener('click', closeDropOptions)\n        };\n    }, [])\n\n    // componentDidUpdate\n    useEffect(() => {\n\n        const calcAmFollowing = (otherUID) => {\n\n            var follow = follows\n                .filter(follow => {\n                    return follow.to === otherUID && follow.from === props.uid\n                })\n            setAmFollowing(follow.length === 0 ? false : true)\n        }\n\n        if (props.rapper) {\n            console.log(props.rapper)\n            setImgURL(props.rapper.photoURL)\n            calcAmFollowing(props.rapper.uid)\n        }\n        if (props.blurb) {\n            setBlurbText(props.blurb)\n        }\n    }, [props.photoRef, props.rapper, follows, props.uid, props.blurb])\n\n    const fetchFollows = async () => {\n        var db = firebase.firestore()\n        var follows = await db.collection(\"follows\").get().then(((querySnapshot) => {\n            var fetchedFollows = []\n            querySnapshot.forEach(doc => {\n                fetchedFollows.push({\n                    ...doc.data(),\n                    fid: doc.id\n                })\n            })\n            return fetchedFollows\n        }))\n        setFollows(follows)\n\n    }\n\n\n    const follow = () => {\n        setAmFollowing(true)\n        var db = firebase.firestore()\n        db.collection('follows').add({\n            from: props.uid,\n            to: props.rapper.uid\n        })\n            .then(() => fetchFollows())\n            .catch(err => console.log(err.message))\n    }\n\n    const unfollow = () => {\n        setAmFollowing(false)\n        var db = firebase.firestore()\n        db.collection('follows')\n            .where('from', '==', props.uid)\n            .where('to', '==', props.rapper.uid)\n            .get()\n            .then(snap => {\n                snap.forEach(doc => {\n                    doc.ref.delete()\n                })\n                fetchFollows()\n            })\n            .catch(err => console.log(err))\n    }\n\n    const addhttp = (url) => {\n        if (!/^(?:f|ht)tps?\\:\\/\\//.test(url)) {\n            url = \"http://\" + url;\n        }\n        return url;\n    }\n\n    const closeDropOptions = (event) => {\n        if (!event.target.classList.contains('spotlight__three-dots') && !event.target.classList.contains('dot')) {\n            toggleDropOptions(false)\n        }\n    }\n\n\n    var username = props.rapper ?\n        <div className='block-one__username'>{props.rapper ? props.rapper.username : null}</div>\n        : <h2 className='block-one__select-a-user'>Select a User</h2>\n    var addressGender = props.rapper ?\n        <div className='block-one__address-gender'>{props.rapper ? props.rapper.city : null}, {props.rapper ? props.rapper.state : null} | {props.rapper ? props.rapper.gender : null}</div>\n        : null\n\n\n    var photo = props.rapper ?\n        <div className='block-one__img-wrapper'>\n            <div>\n                <img alt='' src={imgURL} />\n                {props.rapper.rank === 1 ? \n                    <i class=\"fas fa-crown crown\"></i> \n                    : null}\n            </div>\n\n        </div>\n        : null\n    var button = <button className='follow-button' onClick={follow}>follow</button>\n    if (amFollowing) {\n        button = <button className='follow-button' onClick={unfollow}>following</button>\n    }\n    var handles = null;\n\n\n    if (props.rapper && (props.rapper.handles.facebook\n        || props.rapper.handles.soundcloud\n        || props.rapper.handles.instagram\n        || props.rapper.handles.youtube)) {\n        handles = (<div className='block-one__handles-container'>\n            {props.rapper && props.rapper.handles.facebook ?\n                <a href={addhttp(props.rapper.handles.facebook)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-facebook-f icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.instagram ?\n                <a href={addhttp(props.rapper.handles.instagram)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-instagram icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.soundcloud ?\n                <a href={addhttp(props.rapper.handles.soundcloud)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-soundcloud icon\"></i>\n                </a> : null}\n            {props.rapper && props.rapper.handles.youtube ?\n                <a href={addhttp(props.rapper.handles.youtube)} rel=\"noopener noreferrer\" target=\"_blank\">\n                    <i className=\"fab fa-youtube icon\"></i>\n                </a> : null}\n        </div>)\n    }\n    console.log(props.rapper)\n    return (\n        <div className='spotlight' >\n            <div className='spotlight__block-one'>\n\n                {photo}\n                {username}\n                {addressGender}\n                {handles}\n\n                <p className='block-one__blurb' style={{ cursor: 'text' }}>\n                    {props.rapper ? props.rapper.blurb : null}\n                </p>\n            </div>\n            <div className='spotlight__block-two' style={{ fontSize: '.7em' }}>\n                {props.focus === 'them' ? button : null}\n                <div>{props.rapper ? props.rapper.rank + getOrdinal(props.rapper.rank) + ' place' : null} </div>\n                <div>{props.rapper ? props.rapper.votes + (props.rapper.votes === 1 ? ' point' : ' points') : null} </div>\n\n            </div>\n        </div>\n    )\n}\n\n\nconst mapStateToProps = state => {\n    return {\n        uid: state.uid,\n        email: state.email,\n        username: state.username,\n        sex: state.gender,\n        address: state.address,\n        zipcode: state.address.zip_code,\n        city: state.address.city,\n        state: state.address.state,\n        needsInfo: state.needsInfo,\n        photoURL: state.photoURL,\n        blurb: state.blurb\n    }\n}\n\n\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        postUserData: (uid, data) => dispatch(postUserData(uid, data)),\n        logout: () => dispatch({ type: actionTypes.LOG_OUT })\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Spotlight)\n"]},"metadata":{},"sourceType":"module"}