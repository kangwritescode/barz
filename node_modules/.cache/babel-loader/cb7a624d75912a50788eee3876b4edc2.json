{"ast":null,"code":"import _slicedToArray from \"/Users/davidkang/Desktop/local-barz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/davidkang/Desktop/local-barz/src/containers/Hub/FollowBox/FollowBox.js\";\nimport React, { useState, useEffect } from 'react';\nimport firebase from 'firebase';\nimport { connect } from 'react-redux';\nimport './FollowBox.css';\n\nfunction FollowBox(props) {\n  const followBoxClasses = ['follow-box', 'follow-box__header', 'follow-box_body', \"header__section\"]; // follows\n\n  const _useState = useState(0),\n        _useState2 = _slicedToArray(_useState, 2),\n        followedByCount = _useState2[0],\n        setFollowedByCount = _useState2[1];\n\n  const _useState3 = useState(0),\n        _useState4 = _slicedToArray(_useState3, 2),\n        followingCount = _useState4[0],\n        setFollowingCount = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        followedUIDs = _useState6[0],\n        setFollowedBy = _useState6[1];\n\n  const _useState7 = useState([]),\n        _useState8 = _slicedToArray(_useState7, 2),\n        followingUIDs = _useState8[0],\n        setFollowing = _useState8[1]; // users\n\n\n  const _useState9 = useState({}),\n        _useState10 = _slicedToArray(_useState9, 2),\n        users = _useState10[0],\n        setUsers = _useState10[1];\n\n  const _useState11 = useState([]),\n        _useState12 = _slicedToArray(_useState11, 2),\n        followedUsers = _useState12[0],\n        setFollowedUsers = _useState12[1];\n\n  const _useState13 = useState([]),\n        _useState14 = _slicedToArray(_useState13, 2),\n        followingUsers = _useState14[0],\n        setFollowingUsers = _useState14[1]; //ui\n\n\n  const _useState15 = useState(''),\n        _useState16 = _slicedToArray(_useState15, 2),\n        focusOn = _useState16[0],\n        setFocusOn = _useState16[1];\n\n  useEffect(() => {\n    document.addEventListener('click', toggleFocus);\n    return () => {\n      document.removeEventListener('click', toggleFocus);\n    };\n  }, []);\n  useEffect(() => {\n    var db = firebase.firestore();\n\n    const fetchFollowers = async () => {\n      return db.collection('follows').where('to', '==', props.uid).onSnapshot(snapshot => {\n        setFollowedByCount(snapshot.size);\n        var arr = [];\n        snapshot.forEach(doc => {\n          arr.push(doc.data().from);\n        });\n        setFollowedBy(arr);\n      });\n    };\n\n    const fetchFollowing = async () => {\n      return db.collection('follows').where('from', '==', props.uid).onSnapshot(snapshot => {\n        setFollowingCount(snapshot.size);\n        var arr = [];\n        snapshot.forEach(doc => {\n          arr.push(doc.data().to);\n        });\n        setFollowing(arr);\n      });\n    };\n\n    const fetchUsers = async () => {\n      return db.collection('users').onSnapshot(snap => {\n        var users = {};\n        snap.forEach(doc => {\n          users[doc.id] = doc.data();\n        });\n        setUsers(users);\n      });\n    };\n\n    if (props.uid) {\n      var usersPromise = fetchUsers();\n      var followersPromise = fetchFollowers();\n      var followingPromise = fetchFollowing();\n      return () => {\n        followersPromise.then(listener => listener());\n        followingPromise.then(listener => listener());\n        usersPromise.then(listener => listener());\n      };\n    }\n  }, [props.uid]);\n\n  const toggleFocus = event => {\n    var clickedOnFollowBox = false;\n    followBoxClasses.forEach(className => {\n      if (event.target.classList.contains(className)) {\n        clickedOnFollowBox = true;\n      }\n    });\n\n    if (clickedOnFollowBox) {\n      return;\n    } else {\n      setFocusOn('');\n    }\n  };\n\n  const expandedBody = focusOn ? 'follow-box__expanded' : 'follow-box__compressed';\n  const followersFocused = focusOn === 'followers' ? 'focused' : null;\n  const followingFocused = focusOn === 'following' ? 'focused' : null;\n  var focusedBarStyle = null;\n\n  if (focusOn === 'following') {\n    focusedBarStyle = 'under-following';\n  } else if (focusOn === 'followers') {\n    focusedBarStyle = 'under-followers';\n  }\n\n  return React.createElement(\"div\", {\n    className: \"follow-box\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"follow-box__header \".concat(focusOn ? 'follow-box_header-filled' : 'follow-box_header-unfilled'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"header__section \".concat(followersFocused),\n    onClick: () => setFocusOn(focusOn === 'followers' ? '' : 'followers'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, followedByCount, \" \", 'follower' + (followedByCount !== 1 ? 's' : ''), React.createElement(\"div\", {\n    className: \"focused-bar \".concat(focusedBarStyle),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"header__section \".concat(followingFocused),\n    onClick: () => setFocusOn(focusOn === 'following' ? '' : 'following'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, followingCount, \" following\")), React.createElement(\"div\", {\n    className: \"follow-box_body \".concat(expandedBody),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }));\n}\n\nconst mapStateToProps = state => {\n  return {\n    uid: state.uid\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FollowBox);","map":{"version":3,"sources":["/Users/davidkang/Desktop/local-barz/src/containers/Hub/FollowBox/FollowBox.js"],"names":["React","useState","useEffect","firebase","connect","FollowBox","props","followBoxClasses","followedByCount","setFollowedByCount","followingCount","setFollowingCount","followedUIDs","setFollowedBy","followingUIDs","setFollowing","users","setUsers","followedUsers","setFollowedUsers","followingUsers","setFollowingUsers","focusOn","setFocusOn","document","addEventListener","toggleFocus","removeEventListener","db","firestore","fetchFollowers","collection","where","uid","onSnapshot","snapshot","size","arr","forEach","doc","push","data","from","fetchFollowing","to","fetchUsers","snap","id","usersPromise","followersPromise","followingPromise","then","listener","event","clickedOnFollowBox","className","target","classList","contains","expandedBody","followersFocused","followingFocused","focusedBarStyle","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport firebase from 'firebase'\nimport { connect } from 'react-redux'\nimport './FollowBox.css'\n\nfunction FollowBox(props) {\n\n    const followBoxClasses = [\n        'follow-box',\n        'follow-box__header',\n        'follow-box_body',\n        \"header__section\"\n    ]\n\n    // follows\n    const [followedByCount, setFollowedByCount] = useState(0)\n    const [followingCount, setFollowingCount] = useState(0)\n    const [followedUIDs, setFollowedBy] = useState([])\n    const [followingUIDs, setFollowing] = useState([])\n    // users\n    const [users, setUsers] = useState({})\n    const [followedUsers, setFollowedUsers] = useState([])\n    const [followingUsers, setFollowingUsers] = useState([])\n    //ui\n    const [focusOn, setFocusOn] = useState('')\n\n\n    useEffect(() => {\n        document.addEventListener('click', toggleFocus)\n        return () => {\n            document.removeEventListener('click', toggleFocus)\n        };\n    }, [])\n\n    useEffect(() => {\n        var db = firebase.firestore()\n        const fetchFollowers = async () => {\n            return db.collection('follows').where('to', '==', props.uid)\n                .onSnapshot(snapshot => {\n                    setFollowedByCount(snapshot.size)\n                    var arr = []\n                    snapshot.forEach(doc => {\n                        arr.push(doc.data().from)\n                    })\n                    setFollowedBy(arr)\n                })\n        }\n        const fetchFollowing = async () => {\n            return db.collection('follows').where('from', '==', props.uid)\n                .onSnapshot(snapshot => {\n                    setFollowingCount(snapshot.size)\n                    var arr = []\n                    snapshot.forEach(doc => {\n                        arr.push(doc.data().to)\n                    })\n                    setFollowing(arr)\n                })\n        }\n        const fetchUsers = async () => {\n            return db.collection('users').onSnapshot(snap => {\n                var users = {}\n                snap.forEach(doc => {\n                    users[doc.id] = doc.data()\n                })\n                setUsers(users)\n            })\n        }\n        if (props.uid) {\n            var usersPromise = fetchUsers()\n            var followersPromise = fetchFollowers()\n            var followingPromise = fetchFollowing()\n            return () => {\n                followersPromise.then(listener => listener())\n                followingPromise.then(listener => listener())\n                usersPromise.then(listener => listener())\n            }\n        }\n    }, [props.uid])\n\n    const toggleFocus = (event) => {\n        var clickedOnFollowBox = false;\n        followBoxClasses.forEach(className => {\n            if (event.target.classList.contains(className)) {\n                clickedOnFollowBox = true\n            }\n        });\n        if (clickedOnFollowBox) {\n            return\n        } else {\n            setFocusOn('')\n        }\n\n    }\n\n    \n    \n\n\n\n    const expandedBody = focusOn ? 'follow-box__expanded' : 'follow-box__compressed'\n    const followersFocused = focusOn === 'followers' ? 'focused' : null\n    const followingFocused = focusOn === 'following' ? 'focused' : null\n\n    var focusedBarStyle = null;\n    if (focusOn === 'following') {\n        focusedBarStyle = 'under-following'\n    } else if (focusOn === 'followers') {\n        focusedBarStyle = 'under-followers'\n    }\n\n    return (\n        <div className='follow-box'>\n            <div className={`follow-box__header ${focusOn ? 'follow-box_header-filled' : 'follow-box_header-unfilled'}`}>\n                <div className={`header__section ${followersFocused}`} onClick={() => setFocusOn(focusOn === 'followers' ? '' : 'followers')}>\n                    {followedByCount} {'follower' + (followedByCount !== 1 ? 's' : '')}\n                    <div className={`focused-bar ${focusedBarStyle}`}></div>\n                </div>\n                <div className={`header__section ${followingFocused}`} onClick={() => setFocusOn(focusOn === 'following' ? '' : 'following')}>\n                    {followingCount} following\n                </div>\n            </div>\n            <div className={`follow-box_body ${expandedBody}`}>\n\n            </div>\n        </div>\n    )\n}\n\nconst mapStateToProps = state => {\n    return {\n        uid: state.uid,\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n\n    }\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FollowBox)\n"]},"metadata":{},"sourceType":"module"}